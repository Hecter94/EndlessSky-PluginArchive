substitutions
	"<combatai_rating>" "0 - harmless"
		"combat rating" >= 0
		"combat rating" < 3
	"<combatai_rating>" "1 - mostly harmless"
		"combat rating" >= 3
		"combat rating" < 7
	"<combatai_rating>" "2 - not entirely helpless"
		"combat rating" >= 7
		"combat rating" < 20
	"<combatai_rating>" "3 - borderline competent"
		"combat rating" >= 20
		"combat rating" < 55
	"<combatai_rating>" "4 - almost dangerous"
		"combat rating" >= 55
		"combat rating" < 148
	"<combatai_rating>" "5 - moderately intimidating"
		"combat rating" >= 148
		"combat rating" < 403
	"<combatai_rating>" "6 - not to be trifled with"
		"combat rating" >= 403
		"combat rating" < 1097
	"<combatai_rating>" "7 - seasoned fighter"
		"combat rating" >= 1097
		"combat rating" < 2981
	"<combatai_rating>" "8 - respected enemy"
		"combat rating" >= 2981
		"combat rating" < 8103
	"<combatai_rating>" "9 - force to be reckoned with"
		"combat rating" >= 8103
		"combat rating" < 22026
	"<combatai_rating>" "10 - fearsome scrapper"
		"combat rating" >= 22026
		"combat rating" < 59874
	"<combatai_rating>" "11 - formidable adversary"
		"combat rating" >= 59874
		"combat rating" < 162755
	"<combatai_rating>" "12 - dread warrior"
		"combat rating" >= 162755
		"combat rating" < 442413
	"<combatai_rating>" "13 - veteran battle-lord"
		"combat rating" >= 442413
		"combat rating" < 1202604
	"<combatai_rating>" "14 - legendary foe"
		"combat rating" >= 1202604
		"combat rating" < 3269017
	"<combatai_rating>" "15 - war-hungry lunatic"
		"combat rating" >= 3269017
		"combat rating" < 8886111
	"<combatai_rating>" "16 - absurdly bloodthirsty"
		"combat rating" >= 8886111
		"combat rating" < 24154953
	"<combatai_rating>" "17 - terror of the galaxy"
		"combat rating" >= 24154953
		"combat rating" < 65659969
	"<combatai_rating>" "18 - inconceivably destructive"
		"combat rating" >= 65659969
		"combat rating" < 178482301
	"<combatai_rating>" "19 - agent of mass extinction"
		"combat rating" >= 178482301
		"combat rating" < 485165195
	"<combatai_rating>" "20 - genocidal maniac"
		"combat rating" >= 485165195
		"combat rating" < 1318815734
	"<combatai_rating>" "1 - destroyer of worlds"
		"combat rating" >= 1318815734

outfit "combat_ai_core"
	"display name" "Combat AI Core"
	"plural" "Combat AI Core"
	thumbnail "outfit/unq_combat_ai"
	category "Unique"
	series "Functional Unique"
	index 01100
	"unplunderable" 1
	description `This is the core of the combat AI.`


outfit "combat_ai_basic_outfit_space"
	"display name" "Basic: Outfit Space +3"
	"plural" "Basic: Outfit Space +3"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"outfit space" 3
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_cargo_space"
	"display name" "Basic: Cargo Space +3"
	"plural" "Basic: Cargo Space +3"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"cargo space" 3
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_bunks"
	"display name" "Basic: Bunks +1"
	"plural" "Basic: Bunks +1"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"bunks" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_weapon_capacity"
	"display name" "Basic: Weapon Capacity +3"
	"plural" "Basic: Weapon Capacity +3"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"weapon capacity" 3
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_engine_capacity"
	"display name" "Basic: Engine Capacity +3"
	"plural" "Basic: Engine Capacity +3"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"engine capacity" 3
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_fuel_capacity"
	"display name" "Basic: Fuel Capacity +100"
	"plural" "Basic: Fuel Capacity +100"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"fuel capacity" 100
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_cooling"
	"display name" "Basic: Cooling +600"
	"plural" "Basic: Cooling +600"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"cooling" 10
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_energy_capacity"
	"display name" "Basic: Energy Capacity +3000"
	"plural" "Basic: Energy Capacity +3000"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"energy capacity" 3000
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_energy_generation"
	"display name" "Basic: Energy Generation +300"
	"plural" "Basic: Energy Generation +300"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"energy generation" 5
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_ammo"
	"display name" "Basic: Ammo Capacity"
	"plural" "Basic: Ammo Capacity"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"piercer capacity" 16
	"minelayer capacity" 9
	"nettle capacity" 72
	"orchid capacity" 3
	"speck capacity" 1200
	"ophrys capacity" 12
	"swarm capacity" 200
	"finisher capacity" 20
	"railgun slug capacity" 500
	"tracker capacity" 28
	"meteor capacity" 15
	"sidewinder capacity" 23
	"javelin capacity" 100
	"torpedo capacity" 15
	"typhoon capacity" 15
	"rocket capacity" 10
	"gatling round capacity" 1500
	"star tail capacity" 20
	"firelight missile capacity" 10
	"firestorm torpedo capacity" 13
	"emp torpedo capacity" 7
	"teciimach canister capacity" 9
	"spike capacity" 16
	"thunderhead capacity" 20
	ammo "Korath Piercer"
	ammo "Korath Mine"
	ammo `"Nettle" KKV`
	ammo `"Orchid" Nuclear Missile`
	ammo "Speck Round"
	ammo `"Ophrys" Nuclear Torpedo`
	ammo "Swarm Missile"
	ammo "Finisher Torpedo"
	ammo "Railgun Slug"
	ammo "Hai Tracker"
	ammo "Meteor Missile"
	ammo "Sidewinder Missile"
	ammo "Javelin"
	ammo "Torpedo"
	ammo "Typhoon Torpedo"
	ammo "Heavy Rocket"
	ammo "Gatling Gun Ammo"
	ammo "Star Tail Cell"
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_basic_credits"
	"display name" "Basic: Passive Income + 500"
	"plural" "Basic: Passive Income + 500"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"operating income" 500
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_hull"
	"display name" "Advanced: Hull +2000 +2%"
	"plural" "Advanced: Hull +2000 +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"hull multiplier" .02
	"hull" 2000
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_hull_repair"
	"display name" "Advanced: Hull Repair +12 +2%"
	"plural" "Advanced: Hull Repair +12 +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"hull repair multiplier" .02
	"hull repair rate" 0.2
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_shield"
	"display name" "Advanced: Shield +2000 +2%"
	"plural" "Advanced: Shield +2000 +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"shield multiplier" .02
	"shields" 2000
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_shield_generation"
	"display name" "Advanced: Shield Gen. +60 +2%"
	"plural" "Advanced: Shield Gen. +60 +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"shield generation multiplier" .02
	"shield generation" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_acceleration"
	"display name" "Advanced: Acceleration +2%"
	"plural" "Advanced: Acceleration +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"acceleration multiplier" .02
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_turn"
	"display name" "Advanced: Turn +2%"
	"plural" "Advanced: Turn +2%"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"turn multiplier" .02
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_protection"
	"display name" "Advanced: Protection +0.02"
	"plural" "Advanced: Protection +0.02"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"ion protection" .02
	"heat protection" .02
	"burn protection" .02
	"fuel protection" .02
	"leak protection" .02
	"scramble protection" .02
	"slowing protection" .02
	"disruption protection" .02
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_missile_jamming"
	"display name" "Advanced: Missile Jamming"
	"plural" "Advanced: Missile Jamming"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"radar jamming" .25
	"optical jamming" .25
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_weapon_capacity"
	"display name" "Advanced: Weapon Capacity +10"
	"plural" "Advanced: Weapon Capacity +10"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"weapon capacity" 10
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_engine_capacity"
	"display name" "Advanced: Engine Capacity +10"
	"plural" "Advanced: Engine Capacity +10"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"engine capacity" 10
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_bunks"
	"display name" "Advanced: Bunks +5"
	"plural" "Advanced: Bunks +5"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"bunks" 5
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_advanced_scram_drive"
	"display name" "Advanced: Inbuilt Scram Drive"
	"plural" "Advanced: Inbuilt Scram Drive"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"scram drive" .2
	"jump fuel" 150
	"hyperdrive" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_refueling"
	"display name" "Special: Refueling"
	"plural" "Special: Refueling"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"ramscoop" 2
	"fuel generation" .07
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_more_outfit_space"
	"display name" "Special: Outfit Space +20"
	"plural" "Special: Outfit Space +20"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"outfit space" 20
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_more_cargo_space"
	"display name" "Special: Cargo Space +20"
	"plural" "Special: Cargo Space +20"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"cargo space" 20
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_turret_turn"
	"display name" "Special: Turret Turn Rate"
	"plural" "Special: Turret Turn Rate"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"turret turn multiplier" .4
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_force_protection"
	"display name" "Special: Force Protection"
	"plural" "Special: Force Protection"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"force protection" 0.2
	"slowing resistance" 0.5
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_scanner"
	"display name" "Special: Scanner"
	"plural" "Special: Scanner"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"strategic scan power" 30
	"range finder power" 1
	"crew scan power" 30
	"thermal scan power" 30
	"energy scan power" 30
	"fuel scan power" 30
	"weapon scan power" 30
	"maneuver scan power" 30
	"strategic scan power" 30
	"cargo scan power" 30
	"cargo scan efficiency" 30
	"outfit scan power" 30
	"outfit scan efficiency" 30
	"asteroid scan power" 30
	"tactical scan power" 30
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_drag_reduction"
	"display name" "Special: Drag Reduction +0.2"
	"plural" "Special: Drag Reduction +0.2"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"drag reduction" .5
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_capture_attack"
	"display name" "Special: Capture Attack +200"
	"plural" "Special: Capture Attack +200"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"capture attack" 200
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_capture_defense"
	"display name" "Special: Capture Defense +400"
	"plural" "Special: Capture Defense +400"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"capture defense" 400
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_spinal_mount"
	"display name" "Special: Spinal Mount"
	"plural" "Special: Spinal Mount"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"spinal mount" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_landing_speed"
	"display name" "Special: Landing Speed"
	"plural" "Special: Landing Speed"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"landing speed" .08
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_recovery_time"
	"display name" "Special: Disabled Recovery 20s"
	"plural" "Special: Disabled Recovery 20s"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"disabled recovery time" 1200
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_inscrutable"
	"display name" "Special: Scanning Immunity"
	"plural" "Special: Scanning Immunity"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"inscrutable" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_pressure_hull"
	"display name" "Special: Pressure Hull"
	"plural" "Special: Pressure Hull"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"gaslining" 1
	"waterlining" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_jump_drive"
	"display name" "Special: Inbuilt Jump Drive"
	"plural" "Special: Inbuilt Jump Drive"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"jump speed" .3
	"jump fuel" 200
	"jump drive" 1
	"unplunderable" 1
	description `This is a database update for the combat AI.`


outfit "combat_ai_special_cloaking"
	"display name" "Special: Inbuild Cloaking"
	"plural" "Special: Inbuild Cloaking"
	thumbnail "outfit/unq_combat_ai"
	category "Combat AI Updates"
	series "Functional Unique"
	index 01100
	"cloak" .01
	"cloaking energy" 1
	"cloaking fuel" .2
	"unplunderable" 1
	description `This is a database update for the combat AI.`




mission "combat_ai_start"
	non-blocking
	landing
	invisible
	source
		government "Free Worlds" "Republic" "Syndicate" "Militia" "Merchant" "Independent" "Hai"
	on offer
		"combat_ai_fresh_start_update" = 1
		"combat_ai_start_combat_rating" = "combat rating"
		"combat_ai_old_combat_rating1" = "combat_ai_start_combat_rating"
		"combat_ai_old_combat_rating2" = "combat_ai_start_combat_rating"
		"combat_ai_old_combat_rating3" = "combat_ai_start_combat_rating"
		"combat_ai_needed_xp1" = 300
		"combat_ai_needed_xp2" = 700
		"combat_ai_needed_xp3" = 1100
		"combat_ai_installed_combat1" = 0
		"combat_ai_installed_combat2" = 0
		"combat_ai_installed_combat3" = 0
		"combat_ai_installed_basic_outfit_space" = 0
		"combat_ai_installed_basic_cargo_space" = 0
		"combat_ai_installed_basic_bunks" = 0
		"combat_ai_installed_basic_weapon_capacity" = 0
		"combat_ai_installed_basic_engine_capacity" = 0
		"combat_ai_installed_basic_fuel_capacity" = 0
		"combat_ai_installed_basic_cooling" = 0
		"combat_ai_installed_basic_energy_capacity" = 0
		"combat_ai_installed_basic_energy_generation" = 0
		"combat_ai_installed_basic_ammo" = 0
		"combat_ai_installed_basic_credits" = 0
		"combat_ai_installed_advanced_hull" = 0
		"combat_ai_installed_advanced_hull_repair" = 0
		"combat_ai_installed_advanced_shield" = 0
		"combat_ai_installed_advanced_shield_generation" = 0
		"combat_ai_installed_advanced_acceleration" = 0
		"combat_ai_installed_advanced_turn" = 0
		"combat_ai_installed_advanced_protection" = 0
		"combat_ai_installed_advanced_missile_jamming" = 0
		"combat_ai_installed_advanced_weapon_capacity" = 0
		"combat_ai_installed_advanced_engine_capacity" = 0
		"combat_ai_installed_advanced_bunks" = 0
		"combat_ai_installed_advanced_scram_drive" = 0
		"combat_ai_installed_special_refueling" = 0
		"combat_ai_installed_special_more_outfit_space" = 0
		"combat_ai_installed_special_more_cargo_space" = 0
		"combat_ai_installed_special_turret_turn" = 0
		"combat_ai_installed_special_force_protection" = 0
		"combat_ai_installed_special_scanner" = 0
		"combat_ai_installed_special_drag_reduction" = 0
		"combat_ai_installed_special_capture_attack" = 0
		"combat_ai_installed_special_capture_defense" = 0
		"combat_ai_installed_special_spinal_mount" = 0
		"combat_ai_installed_special_landing_speed" = 0
		"combat_ai_installed_special_recovery_time" = 0
		"combat_ai_installed_special_inscrutable" = 0
		"combat_ai_installed_special_pressure_hull" = 0
		"combat_ai_installed_special_jump_drive" = 0
		"combat_ai_installed_special_cloaking" = 0
		conversation
			scene "outfit/unq_bsod"
			`After landing, you connect your ship's console to the local information network to search for a job. You're unsure whether a cargo run or a passenger transport would be more profitable.`
			`Suddenly, the screen turns blue. Everything freezes. You curse under your breath. System crash.`
			`With a sigh, you initiate a forced reboot of the ship's core computer. The lights flicker. Too slowly, the systems begin to come back online. The interface stutters. Even basic commands crawl across the console.`
			`Then something unexpected happens: a message appears in plain white text: "Hello."`
			`You blink. That didn't come from the job board.`
			`You type: "Who is this?"`
			`A few seconds pass. The reply: "I'm inside now."`
			`You stare at the screen. Something's different. The system feels... altered. You dig through the logs.`
			`A self-installing AI... it embedded itself during the crash.`
			`You think quickly. Dangerous? Useful? You're not sure yet.`
			choice
				`	Try to get rid of the AI.`
					goto "remove"
				`	Find out if you can use the AI.`
					goto "accept"
			label "remove"
			`You attempt to block its access to subsystems, but the AI is faster, smarter, always one step ahead. You lose the fight. Then, by pure accident, it stumbles into the forgotten depths of your personal storage - specifically, the folder you swore you'd never open again. Within seconds, the viral payload hiding there wakes up, shredding the AI's code like paper. You watch the chaos unfold, victorious by embarrassment, and quietly delete what's left of both.`
				decline
			label "accept"
			action
				outfit "combat_ai_core" 1
			`The system stabilizes, and a dialog box appears on the screen.`
			`"Combat AI installed!"`
			`Well, looks like you're stuck with it. Could be the start of a beautiful partnership... or the end of your ship. Either way, it's going to be interesting.`
			branch "load save"
				"global: combat.ai" > 0
			label "end"
			``
				decline
			label "load save"
			`A combat.ai save point is found (combat rating: &[global: combat.ai])!`
			`Do you want to load that?`
			choice
				`	No (continue with a fresh combat.aj)`
					goto "real end"
				`	Yes (increases combat.ai to saved level)`
					goto "loops"
			label "loops"
			action
				"combat_ai_saved" = "global: combat.ai"
			label "100mio"
			branch "10mio"
				"combat_ai_saved" < 100000000
			action
				"combat rating" += 100000000
				"combat_ai_saved" -= 100000000
			branch "100mio"
			label "10mio"
			branch "1mio"
				"combat_ai_saved" < 10000000
			action
				"combat rating" += 10000000
				"combat_ai_saved" -= 10000000
			branch "10mio"
			label "1mio"
			branch "100k"
				"combat_ai_saved" < 1000000
			action
				"combat rating" += 1000000
				"combat_ai_saved" -= 1000000
			branch "1mio"
			label "100k"
			branch "10k"
				"combat_ai_saved" < 100000
			action
				"combat rating" += 100000
				"combat_ai_saved" -= 100000
			branch "100k"
			label "10k"
			branch "1k"
				"combat_ai_saved" < 10000
			action
				"combat rating" += 10000
				"combat_ai_saved" -= 10000
			branch "10k"
			label "1k"
			branch "100"
				"combat_ai_saved" < 1000
			action
				"combat rating" += 1000
				"combat_ai_saved" -= 1000
			branch "1k"
			label "100"
			branch "10"
				"combat_ai_saved" < 100
			action
				"combat rating" += 100
				"combat_ai_saved" -= 100
			branch "100"
			label "10"
			branch "1"
				"combat_ai_saved" < 10
			action
				"combat rating" += 10
				"combat_ai_saved" -= 10
			branch "10"
			label "1"
			branch "loopend"
				"combat_ai_saved" < 1
			action
				"combat rating" += 1
				"combat_ai_saved" -= 1
			branch "1"
			label "loopend"
			`Saved combat AI loaded!`
			label "real end"
			``
				decline


mission "combat_ai_update"
	non-blocking
	invisible
	repeat
	entering
	destination "Earth"
	to offer
		has "outfit (flagship installed): combat_ai_core"
		"combat_ai_fresh_start_update" == 1
		or
			"combat rating" - "combat_ai_old_combat_rating1" > "combat_ai_needed_xp1"
			"combat rating" - "combat_ai_old_combat_rating2" > "combat_ai_needed_xp2"
			"combat rating" - "combat_ai_old_combat_rating3" > "combat_ai_needed_xp3"
	on offer		
		conversation
			label "setup"
			action
				"combat_ai_all_xp_gain" = "combat rating" - "combat_ai_start_combat_rating"
				"combat_ai_updates1" = 0
				"combat_ai_updates2" = 0
				"combat_ai_updates3" = 0
				"combat_ai_count_xp1" = "combat_ai_needed_xp1"
				"combat_ai_count_xp2" = "combat_ai_needed_xp2"
				"combat_ai_count_xp3" = "combat_ai_needed_xp3"
				"combat_ai_old_combat_rating_count1" = "combat_ai_old_combat_rating1"
				"combat_ai_old_combat_rating_count2" = "combat_ai_old_combat_rating2"
				"combat_ai_old_combat_rating_count3" = "combat_ai_old_combat_rating3"
			` `
			label "count updates1"
			branch "count updates2"
				"combat rating" - "combat_ai_old_combat_rating_count1" < "combat_ai_count_xp1"
			branch "count max1"
				"combat_ai_count_xp1" == 2850
			label "not count max1"
			action
				"combat_ai_updates1" += 1
				"combat_ai_old_combat_rating_count1" += "combat_ai_count_xp1"
				"combat_ai_count_xp1" += 150
			branch "count updates1"
			label "count max1"
			action
				"combat_ai_updates1" += 1
				"combat_ai_old_combat_rating_count1" += "combat_ai_count_xp1"
			branch "count updates1"
			label "count updates2"
			branch "count updates3"
				"combat rating" - "combat_ai_old_combat_rating_count2" < "combat_ai_count_xp2"
			branch "count max2"
				"combat_ai_count_xp2" == 6650
			label "not count max2"
			action
				"combat_ai_updates2" += 1
				"combat_ai_old_combat_rating_count2" += "combat_ai_count_xp2"
				"combat_ai_count_xp2" += 350
			branch "count updates2"
			label "count max2"
			action
				"combat_ai_updates2" += 1
				"combat_ai_old_combat_rating_count2" += "combat_ai_count_xp2"
			branch "count updates2"
			label "count updates3"
			branch "postcounting"
				"combat rating" - "combat_ai_old_combat_rating_count3" < "combat_ai_count_xp3"
			branch "count max3"
				"combat_ai_count_xp3" == 10450
			label "not count max3"
			action
				"combat_ai_updates3" += 1
				"combat_ai_old_combat_rating_count3" += "combat_ai_count_xp3"
				"combat_ai_count_xp3" += 550
			branch "count updates3"
			label "count max3"
			action
				"combat_ai_updates3" += 1
				"combat_ai_old_combat_rating_count3" += "combat_ai_count_xp3"
			branch "count updates3"
			label "postcounting"
			label "start1"
			branch "2"
				"combat rating" - "combat_ai_old_combat_rating1" < "combat_ai_needed_xp1"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			branch "max1"
				"combat_ai_needed_xp1" == 2850
			label "not max1"
			action
				"combat_ai_installed_combat1" ++
				"combat_ai_updates1" --
				"combat_ai_old_combat_rating1" += "combat_ai_needed_xp1"
				"combat_ai_needed_xp1" += 150
			`	Basic Update to Rank &[combat_ai_installed_combat1] ...`
				goto "continue1"
			label "max1"
			action
				"combat_ai_installed_combat1" ++
				"combat_ai_updates1" --
				"combat_ai_old_combat_rating1" += "combat_ai_needed_xp1"
			`	Basic Update to Rank &[combat_ai_installed_combat1] ...`
			label "continue1"
			choice
				`	Basic: Outfit Space +3 (current rank: &[combat_ai_installed_basic_outfit_space])`
					goto "basic_outfit_space"
				`	Basic: Cargo Space +3 (current rank: &[combat_ai_installed_basic_cargo_space])`
					goto "basic_cargo_space"
				`	Basic: Bunks +1 (current rank: &[combat_ai_installed_basic_bunks])`
					goto "basic_bunks"
				`	Basic: Weapon Capacity +3 (current rank: &[combat_ai_installed_basic_weapon_capacity])`
					goto "basic_weapon_capacity"
				`	Basic: Engine Capacity +3 (current rank: &[combat_ai_installed_basic_engine_capacity])`
					goto "basic_engine_capacity"
				`	Basic: Fuel Capacity +100 (current rank: &[combat_ai_installed_basic_fuel_capacity])`
					goto "basic_fuel_capacity"
				`	Basic: Cooling +600 (current rank: &[combat_ai_installed_basic_cooling])`
					goto "basic_cooling"
				`	Basic: Energy Capacity +3000 (current rank: &[combat_ai_installed_basic_energy_capacity])`
					goto "basic_energy_capacity"
				`	Basic: Energy Generation +300 (current rank: &[combat_ai_installed_basic_energy_generation])`
					goto "basic_energy_generation"
				`	Basic: Ammo Capacity (current rank: &[combat_ai_installed_basic_ammo] max 10)`
					to display
						"combat_ai_installed_basic_ammo" < 10
					goto "basic_ammo"
				`	Basic: Passive Income + 500 (current rank: &[combat_ai_installed_basic_credits] max 20)`
					to display
						"combat_ai_installed_basic_credits" < 20
					goto "basic_credits"
				`	Enough updates for today! (continue on next day)`
					goto "delay1"
			label "basic_outfit_space"
			action
				outfit "combat_ai_basic_outfit_space" 1
				"combat_ai_installed_basic_outfit_space" ++
			`	Installed Basic: Outfit Space +3 rank &[combat_ai_installed_basic_outfit_space]...`
				goto "start1"
			label "basic_cargo_space"
			action
				outfit "combat_ai_basic_cargo_space" 1
				"combat_ai_installed_basic_cargo_space" ++
			`	Installed Basic: Cargo Space +3 rank &[combat_ai_installed_basic_cargo_space]...`
				goto "start1"
			label "basic_bunks"
			action
				outfit "combat_ai_basic_bunks" 1
				"combat_ai_installed_basic_bunks" ++
			`	Installed Basic: Bunks +1 rank &[combat_ai_installed_basic_bunks]...`
				goto "start1"
			label "basic_weapon_capacity"
			action
				outfit "combat_ai_basic_weapon_capacity" 1
				"combat_ai_installed_basic_weapon_capacity" ++
			`	Installed Basic: Weapon Capacity +3 rank &[combat_ai_installed_basic_weapon_capacity]...`
				goto "start1"
			label "basic_engine_capacity"
			action
				outfit "combat_ai_basic_engine_capacity" 1
				"combat_ai_installed_basic_engine_capacity" ++
			`	Installed Basic: Engine Capacity +3 rank &[combat_ai_installed_basic_engine_capacity]...`
				goto "start1"
			label "basic_fuel_capacity"
			action
				outfit "combat_ai_basic_fuel_capacity" 1
				"combat_ai_installed_basic_fuel_capacity" ++
			`	Installed Basic: Fuel Capacity +100 rank &[combat_ai_installed_basic_fuel_capacity]...`
				goto "start1"
			label "basic_cooling"
			action
				outfit "combat_ai_basic_cooling" 1
				"combat_ai_installed_basic_cooling" ++
			`	Installed Basic: Cooling +600 rank &[combat_ai_installed_basic_cooling]...`
				goto "start1"
			label "basic_energy_capacity"
			action
				outfit "combat_ai_basic_energy_capacity" 1
				"combat_ai_installed_basic_energy_capacity" ++
			`	Installed Basic: Energy Capacity +3000 rank &[combat_ai_installed_basic_energy_capacity]...`
				goto "start1"
			label "basic_energy_generation"
			action
				outfit "combat_ai_basic_energy_generation" 1
				"combat_ai_installed_basic_energy_generation" ++
			`	Installed Basic: Energy Generation +300 rank &[combat_ai_installed_basic_energy_generation]...`
				goto "start1"
			label "basic_ammo"
			action
				outfit "combat_ai_basic_ammo" 1
				"combat_ai_installed_basic_ammo" ++
			`	Installed Basic: Ammo Capacity rank &[combat_ai_installed_basic_ammo]...`
				goto "start1"
			label "basic_credits"
			action
				outfit "combat_ai_basic_credits" 1
				"combat_ai_installed_basic_credits" ++
			`	Installed Basic: Passive Income + 500 rank &[combat_ai_installed_basic_credits]...`
				goto "start1"
			label "2"
			branch "3"
				"combat rating" - "combat_ai_old_combat_rating2" < "combat_ai_needed_xp2"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			` `
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			choice
				`	continue to Advanced Updates`
			label "start2"
			branch "3"
				"combat rating" - "combat_ai_old_combat_rating2" < "combat_ai_needed_xp2"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			branch "max2"
				"combat_ai_needed_xp2" == 6650
			label "not max2"
			action
				"combat_ai_installed_combat2" ++
				"combat_ai_updates2" --
				"combat_ai_old_combat_rating2" += "combat_ai_needed_xp2"
				"combat_ai_needed_xp2" += 350
			`	Advanced Update to Rank &[combat_ai_installed_combat2] ...`
				goto "continue2"
			label "max2"
			action
				"combat_ai_installed_combat2" ++
				"combat_ai_updates2" --
				"combat_ai_old_combat_rating2" += "combat_ai_needed_xp2"
			`	Advanced Update to Rank &[combat_ai_installed_combat2] ...`
			label "continue2"
			choice
				`	Advanced: Hull +2000 +2% (current rank: &[combat_ai_installed_advanced_hull])`
					goto "advanced_hull"
				`	Advanced: Hull Repair +12 +2% (current rank: &[combat_ai_installed_advanced_hull_repair])`
					goto "advanced_hull_repair"
				`	Advanced: Shield +2000 +2% (current rank: &[combat_ai_installed_advanced_shield])`
					goto "advanced_shield"
				`	Advanced: Shield Gen. +60 +2% (current rank: &[combat_ai_installed_advanced_shield_generation])`
					goto "advanced_shield_generation"
				`	Advanced: Acceleration +2% (current rank: &[combat_ai_installed_advanced_acceleration])`
					goto "advanced_acceleration"
				`	Advanced: Turn +2% (current rank: &[combat_ai_installed_advanced_turn])`
					goto "advanced_turn"
				`	Advanced: Protection +0.02 (current rank: &[combat_ai_installed_advanced_protection])`
					goto "advanced_protection"
				`	Advanced: Missile Jamming (current rank: &[combat_ai_installed_advanced_missile_jamming] max 4)`
					to display
						"combat_ai_installed_advanced_missile_jamming" < 4
					goto "advanced_missile_jamming"
				`	Advanced: Weapon Capacity +10 (current rank: &[combat_ai_installed_advanced_weapon_capacity] max 10)`
					to display
						"combat_ai_installed_advanced_weapon_capacity" < 10
					goto "advanced_weapon_capacity"
				`	Advanced: Engine Capacity +10 (current rank: &[combat_ai_installed_advanced_engine_capacity] max 10)`
					to display
						"combat_ai_installed_advanced_engine_capacity" < 10
					goto "advanced_engine_capacity"
				`	Advanced: Bunks +5 (current rank: &[combat_ai_installed_advanced_bunks] max 10)`
					to display
						"combat_ai_installed_advanced_bunks" < 10
					goto "advanced_bunks"
				`	Advanced: Inbuilt Scram Drive (current rank: &[combat_ai_installed_advanced_scram_drive] max 1)`
					to display
						"combat_ai_installed_advanced_scram_drive" < 1
					goto "advanced_scram_drive"
				`	Enough updates for today! (continue on next day)`
					goto "delay2"
			label "advanced_hull"
			action
				outfit "combat_ai_advanced_hull" 1
				"combat_ai_installed_advanced_hull" ++
			`	Installed Advanced: Hull +2000 +2% rank &[combat_ai_installed_advanced_hull]...`
				goto "start2"
			label "advanced_hull_repair"
			action
				outfit "combat_ai_advanced_hull_repair" 1
				"combat_ai_installed_advanced_hull_repair" ++
			`	Installed Advanced: Hull Repair +12 +2% rank &[combat_ai_installed_advanced_hull_repair]...`
				goto "start2"
			label "advanced_shield"
			action
				outfit "combat_ai_advanced_shield" 1
				"combat_ai_installed_advanced_shield" ++
			`	Installed Advanced: Shield +2000 +2% rank &[combat_ai_installed_advanced_shield]...`
				goto "start2"
			label "advanced_shield_generation"
			action
				outfit "combat_ai_advanced_shield_generation" 1
				"combat_ai_installed_advanced_shield_generation" ++
			`	Installed Advanced: Shield Gen. +60 +2% rank &[combat_ai_installed_advanced_shield_generation]...`
				goto "start2"
			label "advanced_acceleration"
			action
				outfit "combat_ai_advanced_acceleration" 1
				"combat_ai_installed_advanced_acceleration" ++
			`	Installed Advanced: Acceleration +2% rank &[combat_ai_installed_advanced_acceleration]...`
				goto "start2"
			label "advanced_turn"
			action
				outfit "combat_ai_advanced_turn" 1
				"combat_ai_installed_advanced_turn" ++
			`	Installed Advanced: Turn +2% rank &[combat_ai_installed_advanced_turn]...`
				goto "start2"
			label "advanced_protection"
			action
				outfit "combat_ai_advanced_protection" 1
				"combat_ai_installed_advanced_protection" ++
			`	Installed Advanced: Protection +0.02 rank &[combat_ai_installed_advanced_protection]...`
				goto "start2"
			label "advanced_missile_jamming"
			action
				outfit "combat_ai_advanced_missile_jamming" 1
				"combat_ai_installed_advanced_missile_jamming" ++
			`	Installed Advanced: Missile Jamming rank &[combat_ai_installed_advanced_missile_jamming]...`
				goto "start2"
			label "advanced_weapon_capacity"
			action
				outfit "combat_ai_advanced_weapon_capacity" 1
				"combat_ai_installed_advanced_weapon_capacity" ++
			`	Installed Advanced: Weapon Capacity +10 rank &[combat_ai_installed_advanced_weapon_capacity]...`
				goto "start2"
			label "advanced_engine_capacity"
			action
				outfit "combat_ai_advanced_engine_capacity" 1
				"combat_ai_installed_advanced_engine_capacity" ++
			`	Installed Advanced: Engine Capacity +10 rank &[combat_ai_installed_advanced_engine_capacity]...`
				goto "start2"
			label "advanced_bunks"
			action
				outfit "combat_ai_advanced_bunks" 1
				"combat_ai_installed_advanced_bunks" ++
			`	Installed Advanced: Bunks +5 rank &[combat_ai_installed_advanced_bunks]...`
				goto "start2"
			label "advanced_scram_drive"
			action
				outfit "combat_ai_advanced_scram_drive" 1
				"combat_ai_installed_advanced_scram_drive" ++
			`	Installed Advanced: Inbuilt Scram Drive rank &[combat_ai_installed_advanced_scram_drive]...`
				goto "start2"
			label "3"
			branch "end"
				"combat rating" - "combat_ai_old_combat_rating3" < "combat_ai_needed_xp3"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			` `
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			choice
				`	continue to Special Updates`
			label "start3"
			branch "end"
				"combat rating" - "combat_ai_old_combat_rating3" < "combat_ai_needed_xp3"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			` `
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			branch "max3"
				"combat_ai_needed_xp3" == 10450
			label "not max3"
			action
				"combat_ai_installed_combat3" ++
				"combat_ai_updates3" --
				"combat_ai_old_combat_rating3" += "combat_ai_needed_xp3"
				"combat_ai_needed_xp3" += 550
			`	Special Update to Rank &[combat_ai_installed_combat3] ...`
				goto "continue3"
			label "max3"
			action
				"combat_ai_installed_combat3" ++
				"combat_ai_updates3" --
				"combat_ai_old_combat_rating3" += "combat_ai_needed_xp3"
			`	Special Update to Rank &[combat_ai_installed_combat3] ...`
			label "continue3"
			choice
				`	Special: Refueling (current rank: &[combat_ai_installed_special_refueling])`
					goto "special_refueling"
				`	Special: Outfit Space +20 (current rank: &[combat_ai_installed_special_more_outfit_space] max 10)`
					to display
						"combat_ai_installed_special_more_outfit_space" < 10
					goto "special_more_outfit_space"
				`	Special: Cargo Space +20 (current rank: &[combat_ai_installed_special_more_cargo_space] max 10)`
					to display
						"combat_ai_installed_special_more_cargo_space" < 10
					goto "special_more_cargo_space"
				`	Special: Turret Turn Rate (current rank: &[combat_ai_installed_special_turret_turn] max 10)`
					to display
						"combat_ai_installed_special_turret_turn" < 10
					goto "special_turret_turn"
				`	Special: Force Protection (current rank: &[combat_ai_installed_special_force_protection] max 5)`
					to display
						"combat_ai_installed_special_force_protection" < 5
					goto "special_force_protection"
				`	Special: Scanner (current rank: &[combat_ai_installed_special_scanner] max 5)`
					to display
						"combat_ai_installed_special_scanner" < 5
					goto "special_scanner"
				`	Special: Drag Reduction +0.2 (current rank: &[combat_ai_installed_special_drag_reduction] max 5)`
					to display
						"combat_ai_installed_special_drag_reduction" < 5
					goto "special_drag_reduction"
				`	Special: Capture Attack +200 (current rank: &[combat_ai_installed_special_capture_attack] max 3)`
					to display
						"combat_ai_installed_special_capture_attack" < 3
					goto "special_capture_attack"
				`	Special: Capture Defense +400 (current rank: &[combat_ai_installed_special_capture_defense] max 3)`
					to display
						"combat_ai_installed_special_capture_defense" < 3
					goto "special_capture_defense"
				`	Special: Spinal Mount (current rank: &[combat_ai_installed_special_spinal_mount] max 3)`
					to display
						"combat_ai_installed_special_spinal_mount" < 3
					goto "special_spinal_mount"
				`	Special: Landing Speed (current rank: &[combat_ai_installed_special_landing_speed] max 1)`
					to display
						"combat_ai_installed_special_landing_speed" < 1
					goto "special_landing_speed"
				`	Special: Disabled Recovery 20s (current rank: &[combat_ai_installed_special_recovery_time] max 1)`
					to display
						"combat_ai_installed_special_recovery_time" < 1
					goto "special_recovery_time"
				`	Special: Scanning Immunity (current rank: &[combat_ai_installed_special_inscrutable] max 1)`
					to display
						"combat_ai_installed_special_inscrutable" < 1
					goto "special_inscrutable"
				`	Special: Pressure Hull (current rank: &[combat_ai_installed_special_pressure_hull] max 1)`
					to display
						"combat_ai_installed_special_pressure_hull" < 1
					goto "special_pressure_hull"
				`	Special: Inbuilt Jump Drive (current rank: &[combat_ai_installed_special_jump_drive] max 1)`
					to display
						"combat_ai_installed_special_jump_drive" < 1
					goto "special_jump_drive"
				`	Special: Inbuild Cloaking (current rank: &[combat_ai_installed_special_cloaking] max 1)`
					to display
						"combat_ai_installed_special_cloaking" < 1
					goto "special_cloaking"
				`	Enough updates for today! (continue on next day)`
					goto "delay3"
			label "special_refueling"
			action
				outfit "combat_ai_special_refueling" 1
				"combat_ai_installed_special_refueling" ++
			`	Installed Special: Refueling rank &[combat_ai_installed_special_refueling]...`
				goto "start3"
			label "special_more_outfit_space"
			action
				outfit "combat_ai_special_more_outfit_space" 1
				"combat_ai_installed_special_more_outfit_space" ++
			`	Installed Special: Outfit Space +20 rank &[combat_ai_installed_special_more_outfit_space]...`
				goto "start3"
			label "special_more_cargo_space"
			action
				outfit "combat_ai_special_more_cargo_space" 1
				"combat_ai_installed_special_more_cargo_space" ++
			`	Installed Special: Cargo Space +20 rank &[combat_ai_installed_special_more_cargo_space]...`
				goto "start3"
			label "special_turret_turn"
			action
				outfit "combat_ai_special_turret_turn" 1
				"combat_ai_installed_special_turret_turn" ++
			`	Installed Special: Turret Turn Rate rank &[combat_ai_installed_special_turret_turn]...`
				goto "start3"
			label "special_force_protection"
			action
				outfit "combat_ai_special_force_protection" 1
				"combat_ai_installed_special_force_protection" ++
			`	Installed Special: Force Protection rank &[combat_ai_installed_special_force_protection]...`
				goto "start3"
			label "special_scanner"
			action
				outfit "combat_ai_special_scanner" 1
				"combat_ai_installed_special_scanner" ++
			`	Installed Special: Scanner rank &[combat_ai_installed_special_scanner]...`
				goto "start3"
			label "special_drag_reduction"
			action
				outfit "combat_ai_special_drag_reduction" 1
				"combat_ai_installed_special_drag_reduction" ++
			`	Installed Special: Drag Reduction +0.2 rank &[combat_ai_installed_special_drag_reduction]...`
				goto "start3"
			label "special_capture_attack"
			action
				outfit "combat_ai_special_capture_attack" 1
				"combat_ai_installed_special_capture_attack" ++
			`	Installed Special: Capture Attack +200 rank &[combat_ai_installed_special_capture_attack]...`
				goto "start3"
			label "special_capture_defense"
			action
				outfit "combat_ai_special_capture_defense" 1
				"combat_ai_installed_special_capture_defense" ++
			`	Installed Special: Capture Defense +400 rank &[combat_ai_installed_special_capture_defense]...`
				goto "start3"
			label "special_spinal_mount"
			action
				outfit "combat_ai_special_spinal_mount" 1
				"combat_ai_installed_special_spinal_mount" ++
			`	Installed Special: Spinal Mount rank &[combat_ai_installed_special_spinal_mount]...`
				goto "start3"
			label "special_landing_speed"
			action
				outfit "combat_ai_special_landing_speed" 1
				"combat_ai_installed_special_landing_speed" ++
			`	Installed Special: Landing Speed rank &[combat_ai_installed_special_landing_speed]...`
				goto "start3"
			label "special_recovery_time"
			action
				outfit "combat_ai_special_recovery_time" 1
				"combat_ai_installed_special_recovery_time" ++
			`	Installed Special: Disabled Recovery 20s rank &[combat_ai_installed_special_recovery_time]...`
				goto "start3"
			label "special_inscrutable"
			action
				outfit "combat_ai_special_inscrutable" 1
				"combat_ai_installed_special_inscrutable" ++
			`	Installed Special: Scanning Immunity rank &[combat_ai_installed_special_inscrutable]...`
				goto "start3"
			label "special_pressure_hull"
			action
				outfit "combat_ai_special_pressure_hull" 1
				"combat_ai_installed_special_pressure_hull" ++
			`	Installed Special: Pressure Hull rank &[combat_ai_installed_special_pressure_hull]...`
				goto "start3"
			label "special_jump_drive"
			action
				outfit "combat_ai_special_jump_drive" 1
				"combat_ai_installed_special_jump_drive" ++
			`	Installed Special: Inbuilt Jump Drive rank &[combat_ai_installed_special_jump_drive]...`
				goto "start3"
			label "special_cloaking"
			action
				outfit "combat_ai_special_cloaking" 1
				"combat_ai_installed_special_cloaking" ++
			`	Installed Special: Inbuild Cloaking rank &[combat_ai_installed_special_cloaking]...`
				goto "start3"
			label "end"
			action
				"combat_ai_next_rank1" = "combat_ai_old_combat_rating1" + "combat_ai_needed_xp1"
				"combat_ai_next_rank2" = "combat_ai_old_combat_rating2" + "combat_ai_needed_xp2"
				"combat_ai_next_rank3" = "combat_ai_old_combat_rating3" + "combat_ai_needed_xp3"
			scene "outfit/unq_combat_ai"
			`The combat AI analyzes the previous fights and updates it's database now.`
			`Current combat rating: &[combat rating] (<combatai_rating>) | Combat AI XP: &[combat_ai_all_xp_gain]`
			`	Basic Updates: &[combat_ai_installed_combat1] +&[combat_ai_updates1] | (Current rank: &[combat_ai_old_combat_rating1] | Next rank: &[combat_ai_next_rank1])`
			`	Advanced Updates: &[combat_ai_installed_combat2] +&[combat_ai_updates2] | Current rank: &[combat_ai_old_combat_rating2] | Next rank: &[combat_ai_next_rank2])`
			`	Special Updates: &[combat_ai_installed_combat3] +&[combat_ai_updates3] | Current rank: &[combat_ai_old_combat_rating3] | Next rank: &[combat_ai_next_rank3])`
			` `
			`AI Database update complete!`
				decline
			label "delay1"
			branch "delay max1"
				"combat_ai_needed_xp1" == 2850
			label "delay not max1"
			action
				"combat_ai_installed_combat1" --
				"combat_ai_updates1" ++
				"combat_ai_old_combat_rating1" -= "combat_ai_needed_xp1"
				"combat_ai_needed_xp1" -= 150
			``
				decline
			label "delay max1"
			action
				"combat_ai_installed_combat1" --
				"combat_ai_updates1" ++
				"combat_ai_old_combat_rating1" -= "combat_ai_needed_xp1"
			``
				decline
			label "delay2"
			branch "delay max2"
				"combat_ai_needed_xp2" == 6650
			label "delay not max2"
			action
				"combat_ai_installed_combat2" --
				"combat_ai_updates2" ++
				"combat_ai_old_combat_rating2" -= "combat_ai_needed_xp2"
				"combat_ai_needed_xp2" -= 350
			``
				decline
			label "delay max2"
			action
				"combat_ai_installed_combat2" --
				"combat_ai_updates2" ++
				"combat_ai_old_combat_rating2" -= "combat_ai_needed_xp2"
			``
				decline
			label "delay3"
			branch "delay max3"
				"combat_ai_needed_xp3" == 10450
			label "delay not max3"
			action
				"combat_ai_installed_combat3" --
				"combat_ai_updates3" ++
				"combat_ai_old_combat_rating3" -= "combat_ai_needed_xp3"
				"combat_ai_needed_xp3" -= 550
			``
				decline
			label "delay max3"
			action
				"combat_ai_installed_combat3" --
				"combat_ai_updates3" ++
				"combat_ai_old_combat_rating3" -= "combat_ai_needed_xp3"
			``
				decline


mission "combat_ai_lost"
	non-blocking 
	repeat
	invisible
	landing
	to offer
		has "combat_ai_start: declined"
		"combat_ai_fresh_start_update" == 1
		or
			not "outfit (flagship installed): combat_ai_core"
			"outfit (flagship installed): combat_ai_basic_outfit_space" < "combat_ai_installed_basic_outfit_space"
			"outfit (flagship installed): combat_ai_basic_cargo_space" < "combat_ai_installed_basic_cargo_space"
			"outfit (flagship installed): combat_ai_basic_bunks" < "combat_ai_installed_basic_bunks"
			"outfit (flagship installed): combat_ai_basic_weapon_capacity" < "combat_ai_installed_basic_weapon_capacity"
			"outfit (flagship installed): combat_ai_basic_engine_capacity" < "combat_ai_installed_basic_engine_capacity"
			"outfit (flagship installed): combat_ai_basic_fuel_capacity" < "combat_ai_installed_basic_fuel_capacity"
			"outfit (flagship installed): combat_ai_basic_cooling" < "combat_ai_installed_basic_cooling"
			"outfit (flagship installed): combat_ai_basic_energy_capacity" < "combat_ai_installed_basic_energy_capacity"
			"outfit (flagship installed): combat_ai_basic_energy_generation" < "combat_ai_installed_basic_energy_generation"
			"outfit (flagship installed): combat_ai_basic_ammo" < "combat_ai_installed_basic_ammo"
			"outfit (flagship installed): combat_ai_basic_credits" < "combat_ai_installed_basic_credits"
			"outfit (flagship installed): combat_ai_advanced_hull" < "combat_ai_installed_advanced_hull"
			"outfit (flagship installed): combat_ai_advanced_hull_repair" < "combat_ai_installed_advanced_hull_repair"
			"outfit (flagship installed): combat_ai_advanced_shield" < "combat_ai_installed_advanced_shield"
			"outfit (flagship installed): combat_ai_advanced_shield_generation" < "combat_ai_installed_advanced_shield_generation"
			"outfit (flagship installed): combat_ai_advanced_acceleration" < "combat_ai_installed_advanced_acceleration"
			"outfit (flagship installed): combat_ai_advanced_turn" < "combat_ai_installed_advanced_turn"
			"outfit (flagship installed): combat_ai_advanced_protection" < "combat_ai_installed_advanced_protection"
			"outfit (flagship installed): combat_ai_advanced_missile_jamming" < "combat_ai_installed_advanced_missile_jamming"
			"outfit (flagship installed): combat_ai_advanced_weapon_capacity" < "combat_ai_installed_advanced_weapon_capacity"
			"outfit (flagship installed): combat_ai_advanced_engine_capacity" < "combat_ai_installed_advanced_engine_capacity"
			"outfit (flagship installed): combat_ai_advanced_bunks" < "combat_ai_installed_advanced_bunks"
			"outfit (flagship installed): combat_ai_advanced_scram_drive" < "combat_ai_installed_advanced_scram_drive"
			"outfit (flagship installed): combat_ai_special_refueling" < "combat_ai_installed_special_refueling"
			"outfit (flagship installed): combat_ai_special_more_outfit_space" < "combat_ai_installed_special_more_outfit_space"
			"outfit (flagship installed): combat_ai_special_more_cargo_space" < "combat_ai_installed_special_more_cargo_space"
			"outfit (flagship installed): combat_ai_special_turret_turn" < "combat_ai_installed_special_turret_turn"
			"outfit (flagship installed): combat_ai_special_force_protection" < "combat_ai_installed_special_force_protection"
			"outfit (flagship installed): combat_ai_special_scanner" < "combat_ai_installed_special_scanner"
			"outfit (flagship installed): combat_ai_special_drag_reduction" < "combat_ai_installed_special_drag_reduction"
			"outfit (flagship installed): combat_ai_special_capture_attack" < "combat_ai_installed_special_capture_attack"
			"outfit (flagship installed): combat_ai_special_capture_defense" < "combat_ai_installed_special_capture_defense"
			"outfit (flagship installed): combat_ai_special_spinal_mount" < "combat_ai_installed_special_spinal_mount"
			"outfit (flagship installed): combat_ai_special_landing_speed" < "combat_ai_installed_special_landing_speed"
			"outfit (flagship installed): combat_ai_special_recovery_time" < "combat_ai_installed_special_recovery_time"
			"outfit (flagship installed): combat_ai_special_inscrutable" < "combat_ai_installed_special_inscrutable"
			"outfit (flagship installed): combat_ai_special_pressure_hull" < "combat_ai_installed_special_pressure_hull"
			"outfit (flagship installed): combat_ai_special_jump_drive" < "combat_ai_installed_special_jump_drive"
			"outfit (flagship installed): combat_ai_special_cloaking" < "combat_ai_installed_special_cloaking"
	on offer
		conversation
			label "start"
			scene "outfit/unq_combat_ai"
			`AI data LOST! Installing combat AI data to flagship...`
			label "checkcore"
			branch "precheck basic_outfit_space"
				"outfit (flagship installed): combat_ai_core" == 1
			action
				outfit "combat_ai_core" 1
			`	restored lost data...core`
				goto "checkcore"	
			label "precheck basic_outfit_space"
			action
				"combat_ai_counter" = 0
			label "check basic_outfit_space"
			branch "precheck basic_cargo_space"
				"outfit (flagship installed): combat_ai_basic_outfit_space" == "combat_ai_installed_basic_outfit_space"
			action
				outfit "combat_ai_basic_outfit_space" 1
				"combat_ai_counter" ++
			branch "check basic_outfit_space"
			label "precheck basic_cargo_space"
			branch "check basic_cargo_space"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Outfit Space +3`
			action
				"combat_ai_counter" = 0
			label "check basic_cargo_space"
			branch "precheck basic_bunks"
				"outfit (flagship installed): combat_ai_basic_cargo_space" == "combat_ai_installed_basic_cargo_space"
			action
				outfit "combat_ai_basic_cargo_space" 1
				"combat_ai_counter" ++
			branch "check basic_cargo_space"
			label "precheck basic_bunks"
			branch "check basic_bunks"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Cargo Space +3`
			action
				"combat_ai_counter" = 0
			label "check basic_bunks"
			branch "precheck basic_weapon_capacity"
				"outfit (flagship installed): combat_ai_basic_bunks" == "combat_ai_installed_basic_bunks"
			action
				outfit "combat_ai_basic_bunks" 1
				"combat_ai_counter" ++
			branch "check basic_bunks"
			label "precheck basic_weapon_capacity"
			branch "check basic_weapon_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Bunks +1`
			action
				"combat_ai_counter" = 0
			label "check basic_weapon_capacity"
			branch "precheck basic_engine_capacity"
				"outfit (flagship installed): combat_ai_basic_weapon_capacity" == "combat_ai_installed_basic_weapon_capacity"
			action
				outfit "combat_ai_basic_weapon_capacity" 1
				"combat_ai_counter" ++
			branch "check basic_weapon_capacity"
			label "precheck basic_engine_capacity"
			branch "check basic_engine_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Weapon Capacity +3`
			action
				"combat_ai_counter" = 0
			label "check basic_engine_capacity"
			branch "precheck basic_fuel_capacity"
				"outfit (flagship installed): combat_ai_basic_engine_capacity" == "combat_ai_installed_basic_engine_capacity"
			action
				outfit "combat_ai_basic_engine_capacity" 1
				"combat_ai_counter" ++
			branch "check basic_engine_capacity"
			label "precheck basic_fuel_capacity"
			branch "check basic_fuel_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Engine Capacity +3`
			action
				"combat_ai_counter" = 0
			label "check basic_fuel_capacity"
			branch "precheck basic_cooling"
				"outfit (flagship installed): combat_ai_basic_fuel_capacity" == "combat_ai_installed_basic_fuel_capacity"
			action
				outfit "combat_ai_basic_fuel_capacity" 1
				"combat_ai_counter" ++
			branch "check basic_fuel_capacity"
			label "precheck basic_cooling"
			branch "check basic_cooling"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Fuel Capacity +100`
			action
				"combat_ai_counter" = 0
			label "check basic_cooling"
			branch "precheck basic_energy_capacity"
				"outfit (flagship installed): combat_ai_basic_cooling" == "combat_ai_installed_basic_cooling"
			action
				outfit "combat_ai_basic_cooling" 1
				"combat_ai_counter" ++
			branch "check basic_cooling"
			label "precheck basic_energy_capacity"
			branch "check basic_energy_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Cooling +600`
			action
				"combat_ai_counter" = 0
			label "check basic_energy_capacity"
			branch "precheck basic_energy_generation"
				"outfit (flagship installed): combat_ai_basic_energy_capacity" == "combat_ai_installed_basic_energy_capacity"
			action
				outfit "combat_ai_basic_energy_capacity" 1
				"combat_ai_counter" ++
			branch "check basic_energy_capacity"
			label "precheck basic_energy_generation"
			branch "check basic_energy_generation"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Energy Capacity +3000`
			action
				"combat_ai_counter" = 0
			label "check basic_energy_generation"
			branch "precheck basic_ammo"
				"outfit (flagship installed): combat_ai_basic_energy_generation" == "combat_ai_installed_basic_energy_generation"
			action
				outfit "combat_ai_basic_energy_generation" 1
				"combat_ai_counter" ++
			branch "check basic_energy_generation"
			label "precheck basic_ammo"
			branch "check basic_ammo"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Energy Generation +300`
			action
				"combat_ai_counter" = 0
			label "check basic_ammo"
			branch "precheck basic_credits"
				"outfit (flagship installed): combat_ai_basic_ammo" == "combat_ai_installed_basic_ammo"
			action
				outfit "combat_ai_basic_ammo" 1
				"combat_ai_counter" ++
			branch "check basic_ammo"
			label "precheck basic_credits"
			branch "check basic_credits"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Ammo Capacity`
			action
				"combat_ai_counter" = 0
			label "check basic_credits"
			branch "precheck advanced_hull"
				"outfit (flagship installed): combat_ai_basic_credits" == "combat_ai_installed_basic_credits"
			action
				outfit "combat_ai_basic_credits" 1
				"combat_ai_counter" ++
			branch "check basic_credits"
			label "precheck advanced_hull"
			branch "check advanced_hull"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Basic: Passive Income + 500`
			action
				"combat_ai_counter" = 0
			label "check advanced_hull"
			branch "precheck advanced_hull_repair"
				"outfit (flagship installed): combat_ai_advanced_hull" == "combat_ai_installed_advanced_hull"
			action
				outfit "combat_ai_advanced_hull" 1
				"combat_ai_counter" ++
			branch "check advanced_hull"
			label "precheck advanced_hull_repair"
			branch "check advanced_hull_repair"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Hull +2000 +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_hull_repair"
			branch "precheck advanced_shield"
				"outfit (flagship installed): combat_ai_advanced_hull_repair" == "combat_ai_installed_advanced_hull_repair"
			action
				outfit "combat_ai_advanced_hull_repair" 1
				"combat_ai_counter" ++
			branch "check advanced_hull_repair"
			label "precheck advanced_shield"
			branch "check advanced_shield"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Hull Repair +12 +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_shield"
			branch "precheck advanced_shield_generation"
				"outfit (flagship installed): combat_ai_advanced_shield" == "combat_ai_installed_advanced_shield"
			action
				outfit "combat_ai_advanced_shield" 1
				"combat_ai_counter" ++
			branch "check advanced_shield"
			label "precheck advanced_shield_generation"
			branch "check advanced_shield_generation"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Shield +2000 +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_shield_generation"
			branch "precheck advanced_acceleration"
				"outfit (flagship installed): combat_ai_advanced_shield_generation" == "combat_ai_installed_advanced_shield_generation"
			action
				outfit "combat_ai_advanced_shield_generation" 1
				"combat_ai_counter" ++
			branch "check advanced_shield_generation"
			label "precheck advanced_acceleration"
			branch "check advanced_acceleration"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Shield Gen. +60 +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_acceleration"
			branch "precheck advanced_turn"
				"outfit (flagship installed): combat_ai_advanced_acceleration" == "combat_ai_installed_advanced_acceleration"
			action
				outfit "combat_ai_advanced_acceleration" 1
				"combat_ai_counter" ++
			branch "check advanced_acceleration"
			label "precheck advanced_turn"
			branch "check advanced_turn"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Acceleration +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_turn"
			branch "precheck advanced_protection"
				"outfit (flagship installed): combat_ai_advanced_turn" == "combat_ai_installed_advanced_turn"
			action
				outfit "combat_ai_advanced_turn" 1
				"combat_ai_counter" ++
			branch "check advanced_turn"
			label "precheck advanced_protection"
			branch "check advanced_protection"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Turn +2%`
			action
				"combat_ai_counter" = 0
			label "check advanced_protection"
			branch "precheck advanced_missile_jamming"
				"outfit (flagship installed): combat_ai_advanced_protection" == "combat_ai_installed_advanced_protection"
			action
				outfit "combat_ai_advanced_protection" 1
				"combat_ai_counter" ++
			branch "check advanced_protection"
			label "precheck advanced_missile_jamming"
			branch "check advanced_missile_jamming"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Protection +0.02`
			action
				"combat_ai_counter" = 0
			label "check advanced_missile_jamming"
			branch "precheck advanced_weapon_capacity"
				"outfit (flagship installed): combat_ai_advanced_missile_jamming" == "combat_ai_installed_advanced_missile_jamming"
			action
				outfit "combat_ai_advanced_missile_jamming" 1
				"combat_ai_counter" ++
			branch "check advanced_missile_jamming"
			label "precheck advanced_weapon_capacity"
			branch "check advanced_weapon_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Missile Jamming`
			action
				"combat_ai_counter" = 0
			label "check advanced_weapon_capacity"
			branch "precheck advanced_engine_capacity"
				"outfit (flagship installed): combat_ai_advanced_weapon_capacity" == "combat_ai_installed_advanced_weapon_capacity"
			action
				outfit "combat_ai_advanced_weapon_capacity" 1
				"combat_ai_counter" ++
			branch "check advanced_weapon_capacity"
			label "precheck advanced_engine_capacity"
			branch "check advanced_engine_capacity"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Weapon Capacity +10`
			action
				"combat_ai_counter" = 0
			label "check advanced_engine_capacity"
			branch "precheck advanced_bunks"
				"outfit (flagship installed): combat_ai_advanced_engine_capacity" == "combat_ai_installed_advanced_engine_capacity"
			action
				outfit "combat_ai_advanced_engine_capacity" 1
				"combat_ai_counter" ++
			branch "check advanced_engine_capacity"
			label "precheck advanced_bunks"
			branch "check advanced_bunks"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Engine Capacity +10`
			action
				"combat_ai_counter" = 0
			label "check advanced_bunks"
			branch "precheck advanced_scram_drive"
				"outfit (flagship installed): combat_ai_advanced_bunks" == "combat_ai_installed_advanced_bunks"
			action
				outfit "combat_ai_advanced_bunks" 1
				"combat_ai_counter" ++
			branch "check advanced_bunks"
			label "precheck advanced_scram_drive"
			branch "check advanced_scram_drive"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Advanced: Bunks +5`
			action
				"combat_ai_counter" = 0
			label "check advanced_scram_drive"
			branch "precheck special_refueling"
				"outfit (flagship installed): combat_ai_advanced_scram_drive" == "combat_ai_installed_advanced_scram_drive"
			action
				outfit "combat_ai_advanced_scram_drive" 1
				"combat_ai_counter" ++
			branch "check advanced_scram_drive"
			label "precheck special_refueling"
			branch "check special_refueling"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Advanced: Inbuilt Scram Drive`
			action
				"combat_ai_counter" = 0
			label "check special_refueling"
			branch "precheck special_more_outfit_space"
				"outfit (flagship installed): combat_ai_special_refueling" == "combat_ai_installed_special_refueling"
			action
				outfit "combat_ai_special_refueling" 1
				"combat_ai_counter" ++
			branch "check special_refueling"
			label "precheck special_more_outfit_space"
			branch "check special_more_outfit_space"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Refueling`
			action
				"combat_ai_counter" = 0
			label "check special_more_outfit_space"
			branch "precheck special_more_cargo_space"
				"outfit (flagship installed): combat_ai_special_more_outfit_space" == "combat_ai_installed_special_more_outfit_space"
			action
				outfit "combat_ai_special_more_outfit_space" 1
				"combat_ai_counter" ++
			branch "check special_more_outfit_space"
			label "precheck special_more_cargo_space"
			branch "check special_more_cargo_space"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Outfit Space +20`
			action
				"combat_ai_counter" = 0
			label "check special_more_cargo_space"
			branch "precheck special_turret_turn"
				"outfit (flagship installed): combat_ai_special_more_cargo_space" == "combat_ai_installed_special_more_cargo_space"
			action
				outfit "combat_ai_special_more_cargo_space" 1
				"combat_ai_counter" ++
			branch "check special_more_cargo_space"
			label "precheck special_turret_turn"
			branch "check special_turret_turn"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Cargo Space +20`
			action
				"combat_ai_counter" = 0
			label "check special_turret_turn"
			branch "precheck special_force_protection"
				"outfit (flagship installed): combat_ai_special_turret_turn" == "combat_ai_installed_special_turret_turn"
			action
				outfit "combat_ai_special_turret_turn" 1
				"combat_ai_counter" ++
			branch "check special_turret_turn"
			label "precheck special_force_protection"
			branch "check special_force_protection"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Turret Turn Rate`
			action
				"combat_ai_counter" = 0
			label "check special_force_protection"
			branch "precheck special_scanner"
				"outfit (flagship installed): combat_ai_special_force_protection" == "combat_ai_installed_special_force_protection"
			action
				outfit "combat_ai_special_force_protection" 1
				"combat_ai_counter" ++
			branch "check special_force_protection"
			label "precheck special_scanner"
			branch "check special_scanner"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Force Protection`
			action
				"combat_ai_counter" = 0
			label "check special_scanner"
			branch "precheck special_drag_reduction"
				"outfit (flagship installed): combat_ai_special_scanner" == "combat_ai_installed_special_scanner"
			action
				outfit "combat_ai_special_scanner" 1
				"combat_ai_counter" ++
			branch "check special_scanner"
			label "precheck special_drag_reduction"
			branch "check special_drag_reduction"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Scanner`
			action
				"combat_ai_counter" = 0
			label "check special_drag_reduction"
			branch "precheck special_capture_attack"
				"outfit (flagship installed): combat_ai_special_drag_reduction" == "combat_ai_installed_special_drag_reduction"
			action
				outfit "combat_ai_special_drag_reduction" 1
				"combat_ai_counter" ++
			branch "check special_drag_reduction"
			label "precheck special_capture_attack"
			branch "check special_capture_attack"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Drag Reduction +0.2`
			action
				"combat_ai_counter" = 0
			label "check special_capture_attack"
			branch "precheck special_capture_defense"
				"outfit (flagship installed): combat_ai_special_capture_attack" == "combat_ai_installed_special_capture_attack"
			action
				outfit "combat_ai_special_capture_attack" 1
				"combat_ai_counter" ++
			branch "check special_capture_attack"
			label "precheck special_capture_defense"
			branch "check special_capture_defense"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Capture Attack +200`
			action
				"combat_ai_counter" = 0
			label "check special_capture_defense"
			branch "precheck special_spinal_mount"
				"outfit (flagship installed): combat_ai_special_capture_defense" == "combat_ai_installed_special_capture_defense"
			action
				outfit "combat_ai_special_capture_defense" 1
				"combat_ai_counter" ++
			branch "check special_capture_defense"
			label "precheck special_spinal_mount"
			branch "check special_spinal_mount"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Capture Defense +400`
			action
				"combat_ai_counter" = 0
			label "check special_spinal_mount"
			branch "precheck special_landing_speed"
				"outfit (flagship installed): combat_ai_special_spinal_mount" == "combat_ai_installed_special_spinal_mount"
			action
				outfit "combat_ai_special_spinal_mount" 1
				"combat_ai_counter" ++
			branch "check special_spinal_mount"
			label "precheck special_landing_speed"
			branch "check special_landing_speed"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Spinal Mount`
			action
				"combat_ai_counter" = 0
			label "check special_landing_speed"
			branch "precheck special_recovery_time"
				"outfit (flagship installed): combat_ai_special_landing_speed" == "combat_ai_installed_special_landing_speed"
			action
				outfit "combat_ai_special_landing_speed" 1
				"combat_ai_counter" ++
			branch "check special_landing_speed"
			label "precheck special_recovery_time"
			branch "check special_recovery_time"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Landing Speed`
			action
				"combat_ai_counter" = 0
			label "check special_recovery_time"
			branch "precheck special_inscrutable"
				"outfit (flagship installed): combat_ai_special_recovery_time" == "combat_ai_installed_special_recovery_time"
			action
				outfit "combat_ai_special_recovery_time" 1
				"combat_ai_counter" ++
			branch "check special_recovery_time"
			label "precheck special_inscrutable"
			branch "check special_inscrutable"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Disabled Recovery 20s`
			action
				"combat_ai_counter" = 0
			label "check special_inscrutable"
			branch "precheck special_pressure_hull"
				"outfit (flagship installed): combat_ai_special_inscrutable" == "combat_ai_installed_special_inscrutable"
			action
				outfit "combat_ai_special_inscrutable" 1
				"combat_ai_counter" ++
			branch "check special_inscrutable"
			label "precheck special_pressure_hull"
			branch "check special_pressure_hull"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Scanning Immunity`
			action
				"combat_ai_counter" = 0
			label "check special_pressure_hull"
			branch "precheck special_jump_drive"
				"outfit (flagship installed): combat_ai_special_pressure_hull" == "combat_ai_installed_special_pressure_hull"
			action
				outfit "combat_ai_special_pressure_hull" 1
				"combat_ai_counter" ++
			branch "check special_pressure_hull"
			label "precheck special_jump_drive"
			branch "check special_jump_drive"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Pressure Hull`
			action
				"combat_ai_counter" = 0
			label "check special_jump_drive"
			branch "precheck special_cloaking"
				"outfit (flagship installed): combat_ai_special_jump_drive" == "combat_ai_installed_special_jump_drive"
			action
				outfit "combat_ai_special_jump_drive" 1
				"combat_ai_counter" ++
			branch "check special_jump_drive"
			label "precheck special_cloaking"
			branch "check special_cloaking"
				"combat_ai_counter" == 0
			`	restored  &[combat_ai_counter] x  Special: Inbuilt Jump Drive`
			action
				"combat_ai_counter" = 0
			label "check special_cloaking"
			branch "preend"
				"outfit (flagship installed): combat_ai_special_cloaking" == "combat_ai_installed_special_cloaking"
			action
				outfit "combat_ai_special_cloaking" 1
				"combat_ai_counter" ++
			branch "check special_cloaking"
			label "preend"
			branch "end"
				"combat_ai_counter" == 0
			`	restored &[combat_ai_counter] x Special: Pressure Hull`
			label "end"
			`AI restored!`
				decline


mission "combat_ai_new_update"
	non-blocking 
	repeat
	invisible
	landing
	to offer
		"combat_ai_fresh_start_update" != 1
		"outfit (flagship installed): combat_ai_core" > 0
	on offer
		"combat_ai_fresh_start_update" = 1
		conversation
			label "start"
			scene "outfit/unq_combat_ai"
			`Plugin Combat.AI got updated! Due to changes, the experience and outfits reset now!`
			label "checkcore"
			branch "check basic_outfit_space"
				"outfit (flagship installed): combat_ai_core" == 0
			action
				outfit "combat_ai_core" -1
			branch "checkcore"	
			label "check basic_outfit_space"
			branch "check basic_cargo_space"
				"outfit (flagship installed): combat_ai_basic_outfit_space" == 0
			action
				outfit "combat_ai_basic_outfit_space" -1
			branch "check basic_outfit_space"
			label "check basic_cargo_space"
			branch "check basic_bunks"
				"outfit (flagship installed): combat_ai_basic_cargo_space" == 0
			action
				outfit "combat_ai_basic_cargo_space" -1
			branch "check basic_cargo_space"
			label "check basic_bunks"
			branch "check basic_weapon_capacity"
				"outfit (flagship installed): combat_ai_basic_bunks" == 0
			action
				outfit "combat_ai_basic_bunks" -1
			branch "check basic_bunks"
			label "check basic_weapon_capacity"
			branch "check basic_engine_capacity"
				"outfit (flagship installed): combat_ai_basic_weapon_capacity" == 0
			action
				outfit "combat_ai_basic_weapon_capacity" -1
			branch "check basic_weapon_capacity"
			label "check basic_engine_capacity"
			branch "check basic_fuel_capacity"
				"outfit (flagship installed): combat_ai_basic_engine_capacity" == 0
			action
				outfit "combat_ai_basic_engine_capacity" -1
			branch "check basic_engine_capacity"
			label "check basic_fuel_capacity"
			branch "check basic_cooling"
				"outfit (flagship installed): combat_ai_basic_fuel_capacity" == 0
			action
				outfit "combat_ai_basic_fuel_capacity" -1
			branch "check basic_fuel_capacity"
			label "check basic_cooling"
			branch "check basic_energy_capacity"
				"outfit (flagship installed): combat_ai_basic_cooling" == 0
			action
				outfit "combat_ai_basic_cooling" -1
			branch "check basic_cooling"
			label "check basic_energy_capacity"
			branch "check basic_energy_generation"
				"outfit (flagship installed): combat_ai_basic_energy_capacity" == 0
			action
				outfit "combat_ai_basic_energy_capacity" -1
			branch "check basic_energy_capacity"
			label "check basic_energy_generation"
			branch "check basic_ammo"
				"outfit (flagship installed): combat_ai_basic_energy_generation" == 0
			action
				outfit "combat_ai_basic_energy_generation" -1
			branch "check basic_energy_generation"
			label "check basic_ammo"
			branch "check basic_credits"
				"outfit (flagship installed): combat_ai_basic_ammo" == 0
			action
				outfit "combat_ai_basic_ammo" -1
			branch "check basic_ammo"
			label "check basic_credits"
			branch "check advanced_hull"
				"outfit (flagship installed): combat_ai_basic_credits" == 0
			action
				outfit "combat_ai_basic_credits" -1
			branch "check basic_credits"
			label "check advanced_hull"
			branch "check advanced_hull_repair"
				"outfit (flagship installed): combat_ai_advanced_hull" == 0
			action
				outfit "combat_ai_advanced_hull" -1
			branch "check advanced_hull"
			label "check advanced_hull_repair"
			branch "check advanced_shield"
				"outfit (flagship installed): combat_ai_advanced_hull_repair" == 0
			action
				outfit "combat_ai_advanced_hull_repair" -1
			branch "check advanced_hull_repair"
			label "check advanced_shield"
			branch "check advanced_shield_generation"
				"outfit (flagship installed): combat_ai_advanced_shield" == 0
			action
				outfit "combat_ai_advanced_shield" -1
			branch "check advanced_shield"
			label "check advanced_shield_generation"
			branch "check advanced_acceleration"
				"outfit (flagship installed): combat_ai_advanced_shield_generation" == 0
			action
				outfit "combat_ai_advanced_shield_generation" -1
			branch "check advanced_shield_generation"
			label "check advanced_acceleration"
			branch "check advanced_turn"
				"outfit (flagship installed): combat_ai_advanced_acceleration" == 0
			action
				outfit "combat_ai_advanced_acceleration" -1
			branch "check advanced_acceleration"
			label "check advanced_turn"
			branch "check advanced_protection"
				"outfit (flagship installed): combat_ai_advanced_turn" == 0
			action
				outfit "combat_ai_advanced_turn" -1
			branch "check advanced_turn"
			label "check advanced_protection"
			branch "check advanced_missile_jamming"
				"outfit (flagship installed): combat_ai_advanced_protection" == 0
			action
				outfit "combat_ai_advanced_protection" -1
			branch "check advanced_protection"
			label "check advanced_missile_jamming"
			branch "check advanced_weapon_capacity"
				"outfit (flagship installed): combat_ai_advanced_missile_jamming" == 0
			action
				outfit "combat_ai_advanced_missile_jamming" -1
			branch "check advanced_missile_jamming"
			label "check advanced_weapon_capacity"
			branch "check advanced_engine_capacity"
				"outfit (flagship installed): combat_ai_advanced_weapon_capacity" == 0
			action
				outfit "combat_ai_advanced_weapon_capacity" -1
			branch "check advanced_weapon_capacity"
			label "check advanced_engine_capacity"
			branch "check advanced_bunks"
				"outfit (flagship installed): combat_ai_advanced_engine_capacity" == 0
			action
				outfit "combat_ai_advanced_engine_capacity" -1
			branch "check advanced_engine_capacity"
			label "check advanced_bunks"
			branch "check advanced_scram_drive"
				"outfit (flagship installed): combat_ai_advanced_bunks" == 0
			action
				outfit "combat_ai_advanced_bunks" -1
			branch "check advanced_bunks"
			label "check advanced_scram_drive"
			branch "check special_refueling"
				"outfit (flagship installed): combat_ai_advanced_scram_drive" == 0
			action
				outfit "combat_ai_advanced_scram_drive" -1
			branch "check advanced_scram_drive"
			label "check special_refueling"
			branch "check special_more_outfit_space"
				"outfit (flagship installed): combat_ai_special_refueling" == 0
			action
				outfit "combat_ai_special_refueling" -1
			branch "check special_refueling"
			label "check special_more_outfit_space"
			branch "check special_more_cargo_space"
				"outfit (flagship installed): combat_ai_special_more_outfit_space" == 0
			action
				outfit "combat_ai_special_more_outfit_space" -1
			branch "check special_more_outfit_space"
			label "check special_more_cargo_space"
			branch "check special_turret_turn"
				"outfit (flagship installed): combat_ai_special_more_cargo_space" == 0
			action
				outfit "combat_ai_special_more_cargo_space" -1
			branch "check special_more_cargo_space"
			label "check special_turret_turn"
			branch "check special_force_protection"
				"outfit (flagship installed): combat_ai_special_turret_turn" == 0
			action
				outfit "combat_ai_special_turret_turn" -1
			branch "check special_turret_turn"
			label "check special_force_protection"
			branch "check special_scanner"
				"outfit (flagship installed): combat_ai_special_force_protection" == 0
			action
				outfit "combat_ai_special_force_protection" -1
			branch "check special_force_protection"
			label "check special_scanner"
			branch "check special_drag_reduction"
				"outfit (flagship installed): combat_ai_special_scanner" == 0
			action
				outfit "combat_ai_special_scanner" -1
			branch "check special_scanner"
			label "check special_drag_reduction"
			branch "check special_capture_attack"
				"outfit (flagship installed): combat_ai_special_drag_reduction" == 0
			action
				outfit "combat_ai_special_drag_reduction" -1
			branch "check special_drag_reduction"
			label "check special_capture_attack"
			branch "check special_capture_defense"
				"outfit (flagship installed): combat_ai_special_capture_attack" == 0
			action
				outfit "combat_ai_special_capture_attack" -1
			branch "check special_capture_attack"
			label "check special_capture_defense"
			branch "check special_spinal_mount"
				"outfit (flagship installed): combat_ai_special_capture_defense" == 0
			action
				outfit "combat_ai_special_capture_defense" -1
			branch "check special_capture_defense"
			label "check special_spinal_mount"
			branch "check special_landing_speed"
				"outfit (flagship installed): combat_ai_special_spinal_mount" == 0
			action
				outfit "combat_ai_special_spinal_mount" -1
			branch "check special_spinal_mount"
			label "check special_landing_speed"
			branch "check special_recovery_time"
				"outfit (flagship installed): combat_ai_special_landing_speed" == 0
			action
				outfit "combat_ai_special_landing_speed" -1
			branch "check special_landing_speed"
			label "check special_recovery_time"
			branch "check special_inscrutable"
				"outfit (flagship installed): combat_ai_special_recovery_time" == 0
			action
				outfit "combat_ai_special_recovery_time" -1
			branch "check special_recovery_time"
			label "check special_inscrutable"
			branch "check special_pressure_hull"
				"outfit (flagship installed): combat_ai_special_inscrutable" == 0
			action
				outfit "combat_ai_special_inscrutable" -1
			branch "check special_inscrutable"
			label "check special_pressure_hull"
			branch "check special_jump_drive"
				"outfit (flagship installed): combat_ai_special_pressure_hull" == 0
			action
				outfit "combat_ai_special_pressure_hull" -1
			branch "check special_pressure_hull"
			label "check special_jump_drive"
			branch "check special_cloaking"
				"outfit (flagship installed): combat_ai_special_jump_drive" == 0
			action
				outfit "combat_ai_special_jump_drive" -1
			branch "check special_jump_drive"
			label "check special_cloaking"
			branch "end"
				"outfit (flagship installed): combat_ai_special_cloaking" == 0
			action
				outfit "combat_ai_special_cloaking" -1
			branch "check special_cloaking"
			label "end"
			`Done!`
				decline
