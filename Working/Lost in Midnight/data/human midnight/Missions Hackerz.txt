# Copyright (c) 2021 by Michael Arsollon
# derived from original game at https://github.com/endless-sky/endless-sky
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.



# Contents: The Hackerz represent an alternative form of piracy. They scan players like the official government ships.
# But the fines are redirected to their own accounts instead of the government. Destroying a Hackerz drone
# results in fake fines being applied against the player.
# A short job chain is included.


mission "Drone Hacking 1"
	assisting
	repeat
	minor
	source
		category "Drone"
		attributes "cargo scan power" "outfit scan power"
		attributes "automaton"
	to offer
		random < 50
	on offer
		require "Drone Hacking"
		conversation
			scene "outfit/data pad"
			`You've successfully hacked this drone's scanning systems for fun and profit.`
				decline
	on decline
		"How to Hack a Science Drone For Fun and Profit" ++
	# A mission with no destination will not be offered, so give it one.
	# What the destination is doesn't matter, because you always 'decline' this.
	destination "Earth"

mission "Drone Hacking 10"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 8
	on offer
		"salary: Hackerz" += 10
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 10 credits per day from hacked drones.`
				decline

mission "Drone Hacking 100"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 16
	on offer
		"salary: Hackerz" += 90
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 100 credits per day from hacked drones.`
				decline

mission "Drone Hacking 1000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 32
	on offer
		"salary: Hackerz" += 900
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 1000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 2000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 64
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 2000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 3000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 128
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 3000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 4000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 256
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 4000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 5000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 512
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 5000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 6000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 1024
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 6000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 7000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 2048
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 7000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 8000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 4096
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 8000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 9000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 8198
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 9000 credits per day from hacked drones.`
				decline

mission "Drone Hacking 10000"
	landing
	to offer
		"How to Hack a Science Drone For Fun and Profit" >= 16396
	on offer
		"salary: Hackerz" += 1000
		conversation
			scene "outfit/data pad"
			`Your efforts hacking drone scanning systems has paid off. You're earning 10000 credits per day from hacked drones.`
				decline



########################
# Hackerz main
########################



mission "Hackerz"
	landing
	invisible
	deadline 30
	repeat
	source
		government "Republic" "Syndicate" "Free Worlds"
		not attributes "uninhabited"
	to offer
		has "credits" > 1000000
		or
			and
				not "Hackerz 2B: declined"
				or
					and
						"Hackerz: You've Been Hacked: failed" < 20
						random < 25 - "Hackerz: You've Been Hacked: failed"
					and
						"Hackerz: You've Been Hacked: failed" >= 20
						random < 5
			and
				has "Hackerz 2B: declined"
				not "Hackerz 3: failed"
				or
					and
						"Hackerz: You've Been Hacked: failed" < 15
						random < 20 - "Hackerz: You've Been Hacked: failed"
					and
						"Hackerz: You've Been Hacked: failed" >= 15
						random < 5
			and
				has "Hackerz 3: failed"
				not "Hackerz 4: failed"
				or
					and
						"Hackerz: You've Been Hacked: failed" < 10
						random < 15 - "Hackerz: You've Been Hacked: failed"
					and
						"Hackerz: You've Been Hacked: failed" >= 10
						random < 5
			and
				has "Hackerz 4: failed"
				not "Hackerz 5: failed"
				or
					and
						"Hackerz: You've Been Hacked: failed" < 5
						random < 10 - "Hackerz: You've Been Hacked: failed"
					and
						"Hackerz: You've Been Hacked: failed" >= 5
						random < 5
			and
				has "Hackerz 5: failed"
				random < 5

	npc kill
		government "Hackerz"
		personality waiting surveillance
		ship "Hacker Drone" "Hackerz"
		conversation
			branch circuit
				has "outfit (flagship installed): Security Circuit"
			branch node
				has "outfit (flagship installed): Security Node"
			action
				set "You've been hacked"
			scene "ship/science drone"
			`	Your ship's hyperspace network relay starts making unusual sounds. After a moment it returns to normal...`
				accept
			label circuit
			action
				outfit "Security Circuit" -1
				outfit "Security Circuit (Damaged)" 1
			scene "outfit/damaged security circuit"
			`	There's a sudden brief power spike that overloads a Security Circuit! Fortunately, no other systems were damaged...`
				accept
			label node
			action
				outfit "Security Node" -1
				outfit "Security Node (Damaged)" 1
			scene "outfit/damaged security node"
			`	There's a sudden brief power spike that overloads a Security Node! Fortunately, no other systems were damaged...`
				accept


mission "Hackerz: You've Been Hacked"
	landing
	invisible
	repeat
	source
		government "Republic" "Syndicate" "Free Worlds" "Neutral" "Independent"
		not attributes "uninhabited"
	to offer
		has "You've been hacked"
	on offer
		clear "You've been hacked"
		payment -100000
		dialog phrase "Hackerz LOL"
	on accept
		fail

mission "Hackerz 1"
	landing
	source
		government "Republic" "Syndicate" "Free Worlds"
		not attributes "uninhabited"
	to offer
		has "Hackerz: offered"
	on offer
		event "How to Hack a Science Drone"
		log "Factions" "Hackerz" `Someone named "P.K." wrote a guide for hacking into science drones to take advantage of the cargo scan and fine systems used by most governments. Whoever "P.K." is, he must be a madman.`
		conversation
			`As you disembark from your ship, a nearby street vendor tries to sell you a book: "How to Hack a Science Drone For Fun and Profit" for 60 credits.`
			`	The author is listed as "P.K." but no further information is given about this person's identity. It seems to be some sort of 'get rich quick' scheme.`
			choice
				`	(Pay 60 credits for the book.)`
				`	(Do not buy the book.)`
					decline
			action
				outfit "Drone Hacking"
				payment -60
			scene "outfit/data pad"
			`You pay 60 credits for the book and the street vendor hands you a data drive containing a digital copy of "How to Hack a Science Drone For Fun and Profit." Looking it over, there's nothing to indicate whether or not this is a legitimate copy of the book. While you were inspecting the data drive, the street vendor walked away without you noticing...`
				decline

event "How to Hack a Science Drone"
	outfitter "Pirate Basics"
		add "Drone Hacking"
	outfitter "Pirate Advanced"
		add "Drone Hacking"

mission "Patch Drone Hacking"
	landing
	invisible
	to offer
		has "Hackerz 1: declined"
		not "event: How to Hack a Science Drone"
	on offer
		event "How to Hack a Science Drone"
		fail


########################
# The following mission chain is the Hackerz trolling the Bounty Hunters.
# While there is no monetary reward, doing these jobs can reduce how often Hackerz harass the player.
########################


mission "Hackerz 2A"
	job
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <planet> in the <system> system. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination
		government "Pirate"
	to offer
		has "Hackerz 1: declined"
		random < 25

mission "Hackerz 2B"
	landing
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <planet> in the <system> system. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	to offer
		has "Hackerz 2A: done"
	on offer
		conversation
			`The instructions given to you at the job office lead you to a run down farm house far from the space port. There is a simple fence with an unlocked gate surrounding the perimeter.`
			choice
				`	(Check for traps.)`
				`	(Enter through the gate.)`
					goto gate
			
			`	After checking both the fence and gate, you find no traps.`
			
			label gate
			`	With no other entrance in sight, you enter through the gate. You hear a loud squawk and notice some chickens wandering about within the fenced enclosure. The door to the house is just a few steps away.`
			choice
				`	(Enter the front door.)`
					goto door
				`	(Check for a back door entrance.)`
			
			`	You ignore the front entrance and search the other side of the house for a rear entrance. You easily find one.`
			
			label door
			`	After checking the knob, you are surprised to find that the door is unlocked.`
			choice
				`	(Check the door for traps.)`
				`	(Kick the door in!)`
					goto kickin
				
			`	Searching the edges of the door, you find no traps.`
			
			label kickin
			`	You kick in the door with your pistol drawn and yell out "This is a raid! Nobody move!"`
			choice
				`	(Assess the situation.)`
			
			`	The house is quiet and empty. After searching the rooms, you find an old woman dozing off on a couch. There are no computers or networking equipment in the building. She starts to wake up from all the noise you've been making.`
			choice
				`	(Point your gun at her.)`
				`	(Put your gun away.)`
			
			`	After a moment she realizes that she isn't alone and focuses her attention on you. "Hey there youngun'. It's been a spell since I've had a visitor. Would you like some tea?"`
			`	After conversing with her for a while, it doesn't take long for you to realize that you were fed false information.`
				decline
	on decline
		log `Took on a job to locate the Hackerz. False information lead me to an old lady living alone in a dilapidated farm house instead.`


mission "Hackerz 3"
	job
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to a derelict ship, <npc>, in the <system> system. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination "Chiron"
	to offer
		has "Hackerz 2B: declined"
		random < 25
	on offer
		"reputation: Derelict" >?= 0
	to complete
		never
	on enter "Alpha Centauri"
		dialog `You've found the <npc>! Board the ship to catch the Hackerz.`
	npc
		government "Independent (Killable)"
		system destination
		personality waiting staying surveillance mute
		fleet
			names "republic fighter"
			fighters
				names "republic fighter"
			variant
				"Surveillance Drone (ExplosiveSD)"
				"Beacon Drone (ExplosiveSD)"
	npc assist save
		government "Derelict"
		system "Alpha Centauri"
		personality derelict target waiting staying mute marked
		ship "Derelict Bactrian" "P.K.'s Party Palace"
		conversation
			scene "thumbnail/bactrian"
			`When the airlock opens your senses are overwhelmed by the sound of loud music and the scent of burnt recreational herbs. Hundreds of partygoers are too busy enjoying themselves to take notice of your entrance. After searching around for a bit, you find that the ship has power for life support, lighting, and music. But no weapons, navigation, or propulsion. You also haven't found any networking equipment.`
			``
			`Suddenly, you hear panicked screaming coming from the partygoers. When you investigate what's going on, you see that everyone is rushing to abandon ship. You ask one of them what's going on. They yell "Bomb!" while still fleeing. Now would be a good time to run back to your ship.`
				flee
	on fail
		"reputation: Derelict" >?= 0
		log `Took on a job to locate the Hackerz. The information lead me to a rave on a derelict space ship instead. While searching the ship, a bomb was set to explode. I barely escaped. Trying to track down the Hackerz is getting dangerous.`
		dialog `Trying to track down the Hackerz is getting dangerous.`

ship "Derelict Bactrian"
	sprite "ship/bactrian"
	thumbnail "thumbnail/bactrian"
	attributes
		category "Heavy Warship"
		"hull" 8600
		"mass" 940
		"drag" 16.1
		"heat dissipation" .4
		weapon
			"blast radius" 300
			"shield damage" 3000
			"hull damage" 1500
			"hit force" 4500
	explode "large explosion" 40
	explode "huge explosion" 10
	"final explode" "final explosion large"

ship "Explosive Derelict Bactrian"
	sprite "ship/bactrian"
	thumbnail "thumbnail/bactrian"
	attributes
		category "Heavy Warship"
		"hull" 8600
		"mass" 940
		"drag" 16.1
		"heat dissipation" .4
		weapon
			"blast radius" 300
			"shield damage" 3000
			"hull damage" 1500
			"hit force" 4500
	explode "large explosion" 40
	explode "huge explosion" 10
	"final explode" "final explosion large"


mission "Hackerz 3: Result Patch"
	landing
	invisible
	to offer
		or
			has "Hackerz 3: done"
			has "Hackerz 3: declined"
	on offer
		set "Hackerz 3: failed"
		fail	

mission "Hackerz 3: Derelict Patch"
	landing
	invisible
	to offer
		has "Hackerz 3: failed"
		has "reputation: Derelict" < 0
	on offer
		"reputation: Derelict" >?= 0
		fail


mission "Hackerz 4"
	job
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <destination>. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination
		government "Republic" "Syndicate" "Free Worlds"
		distance 4 5
	to offer
		has "Hackerz 3: failed"
		"combat rating" >= 300
		random < 25
	on accept
		conversation
			scene "thumbnail/bactrian"
			`Trying to track down the Hackerz is getting dangerous.`
			``
			`The last time you tried, you were lured onto an exploding Bactrian...`
	to complete
		never
	on visit
		conversation
			branch revisit
				has "Hackerz Angry Bounty Hunter"
			`Your information has lead you to an abandoned warehouse. There don't appear to be any guards or traps. Carefully, you make your way inside the building.`
			choice
				`	(Continue your search.)`

			`	You'd just finished searching the third room when someone kicks in the door down the hall!`
			`	"Filthy Hackerz!" Screams an angry man with a shotgun. "The bounty isn't enough to pay me back all the money you stole!"`
			`	The angry man sees you and opens fire!`
			choice
				`	(Try to reason with him.)`
				`	(Get outta here!)`
					goto dodge
			`	You hold your hands up and try to reason with him. But he is too crazed to have a discussion with. You are hit by a shotgun slug and your headless corpse falls to the floor.`
				die
			label dodge
			action
				set "Hackerz Angry Bounty Hunter"
			`	You narrowly avoid a shotgun slug and jump out the nearest window. Fortunately, the window was already broken, but you still get some minor scrapes from the few shards of glass remaining in the frame. "Better than a shotgun slug to the head," you exclaim to yourself as you run for your ship.`
				launch
			label revisit
			`The angry bountry hunter is still pursuing you in his Headhunter.`
				launch
	npc
		government "Independent (Killable)"
		system destination
		personality waiting staying surveillance mute
		fleet
			names "republic fighter"
			fighters
				names "republic fighter"
			variant
				"Surveillance Drone (ExplosiveSD)" 2
				"Beacon Drone (ExplosiveSD)" 2
	npc save
		to spawn
			has "Hackerz Angry Bounty Hunter"
		government "Bounty Hunter"
		system destination
		personality launching heroic vindictive unconstrained nemesis
		ship "Headhunter (Berserk)" "Payback"

	on fail
		clear "Hackerz Angry Bounty Hunter"
		log `The latest Hackerz job was a dud. Another bounty hunter mistook me for one of them. I'm lucky I didn't lose my head. If I hadn't been interrupted, the abandoned warehouse I was searching would've probably turned out to become another dud. I'm starting to suspect that the job board system itself has been hacked and all of the jobs for tracing the Hackerz are another one of their sick jokes.`
		dialog `Trying to track down the Hackerz is dangerous.`

ship "Headhunter" "Headhunter (Berserk)"
	"never disabled"

mission "Hackerz 4B"
	landing
	invisible
	to offer
		has "Hackerz 4: active"
		has "Hackerz Angry Bounty Hunter"
	on offer
		fail "Hackerz 4"
		clear "Hackerz Angry Bounty Hunter"
		fail

mission "Hackerz 5"
	job
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <destination>. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination "Hope"
	to offer
		has "Hackerz 4: failed"
		"combat rating" >= 1000
		random < 25
	to complete
		never
	on accept
		conversation
			scene "planet/ice2"
			`Hope is an uninhabited frozen wasteland. You know this is probably a trap...`
			``
			`But you've chosen to go anyway.`
	on visit
		conversation
			branch revisit
				has "Trace Hackerz Hope Ambush"
			scene "thumbnail/subsidurial"
			`According to the job posting, the Hackerz are operating out of the abandoned "Subsi Land" amusement park. It's supposed to be buried beneath a ton of ice and snow, but someone must have recently excavated it. A statue of Subsi, the park's mascot character, stands at the entrance, its faded colors almost resembling an actual Subsidurial. The park's rides and attractions are covered in rust, the result from years of being encased in frozen water.`
			``
			`	Suddenly, loud carnival music starts playing and the machines begin reactivating. The Hackerz seem to be rolling out a welcome for you.`
			label navigation
			choice
				`	(Investigate the rides.)`
					goto rides
				`	(Investigate the theater.)`
					goto theater
				`	(Investigate the gift shop.)`
					goto giftshop

			label rides
			`	The nearest ride is a small rail car that goes into a tunnel. Take a seat?`
			choice
				`	(Look somewhere else.)`
					goto navigation
				`	(Get in.)`
			`	As you take a seat, a safety bar secures you in place and the car slowly moves into the tunnel. It's dark at first, but then the tunnel lights up, revealing a variety of colorful Subsidurial shaped robots singing a happy song.`
			choice
				`	(Remain calm.)`
				`	(Duck!)`
					goto ridesavoid
			scene "scene/scene-gatlingsubsi"
			`	A robotic Subsi outfitted with a gatling gun pops up and sprays the rail car with gun fire! The Subsidurial shaped robots continue singing their happy song as the damaged rail car carries your bloody corpse out of the chamber.`
				die
			label ridesavoid
			scene "scene/scene-gatlingsubsi"
			`	You duck just in time as a robotic Subsi outfitted with a gatling gun sprays the rail car with gun fire! The safety bar shakes loose and you are able to flee the amusement ride once the damaged rail car exits the chamber.`
				goto ship

			label theater
			`	The theater seems to be showing the "Subsi and Friends Music Show". Check it out?`
			choice
				`	(Look somewhere else.)`
					goto navigation
				`	(Get in.)`
			`	You take a seat in the theater and the lights fade out. Once it's dark, the stage lights up and the curtain pulls back to reveal several Subsidurial shaped robots singing a happy song.`
			choice
				`	(Remain calm.)`
				`	(Duck!)`
					goto theateravoid
			scene "scene/scene-gatlingsubsi"
			`	A robotic Subsi outfitted with a gatling gun pops up and sprays the theater with gun fire! The Subsidurial shaped robots continue singing their happy song as your bloody corpse slumps onto the theater floor.`
				die
			label theateravoid
			scene "scene/scene-gatlingsubsi"
			`	You duck just in time as a robotic Subsi outfitted with a gatling gun sprays the theater with gun fire! Eventually it runs out of bullets and you are able to escape the theater.`
				goto ship

			label giftshop
			`	The gift shop has "Subsi and Friends" merchandise on display. Go inside?`
			choice
				`	(Look somewhere else.)`
					goto navigation
				`	(Get in.)`
			scene "outfit/subsidurial plushie"
			`	The inside of the store is in much better condition than the outside. The Subsidurial plushies even look good as new. As you walk near a display, a giant Subsi robot pops out of a nearby wall panel.`
			choice
				`	(Remain calm.)`
				`	(Duck!)`
					goto giftshopavoid
			scene "scene/scene-gatlingsubsi"
			`	A hidden gatling gun extends from the robot's mouth and sprays the gift shop with gun fire! Eventually it stops firing and the robot retracts back into the wall. The lifeless eyes of the Subsidurial plushies silently watch over your bloody corpse.`
				die
			label giftshopavoid
			scene "scene/scene-gatlingsubsi"
			`	You duck behind some cover as a hidden gatling gun extends from the robot's mouth and sprays the gift shop with gun fire! Eventually it stops firing and the robot retracts back into the wall, allowing you to escape the gift shop.`
				goto ship

			label ship
			action
				set "Trace Hackerz Hope Ambush"
			``
			`	As you run, several more Subsidurial shaped robots armed with gatling guns appear and open fire. By now, it's obvious that the whole amusement park is rigged with these robots. Once you are safely aboard your ship, you fire up the engines and begin to lift off. As you clear the atmosphere, the warning alarms start blaring. A swarm of drones is headed for you.`
				launch
			label revisit
			`The hostile drones are still targetting you.`
				launch
	npc
		government "Independent (Killable)"
		system destination
		personality waiting staying surveillance mute
		fleet
			names "republic fighter"
			fighters
				names "republic fighter"
			variant
				"Surveillance Drone (ExplosiveSD)" 3
				"Beacon Drone (ExplosiveSD)" 3
	npc save
		to spawn
			has "Trace Hackerz Hope Ambush"
			"How to Hack a Science Drone For Fun and Profit" <= 0
		government "Phenomenon (dangerous)"
		system destination
		personality target waiting staying vindictive marked mute
			confusion 60
		fleet
			variant
				"Combat Drone (ExplosiveSD)" 20
				"Mining Drone (ExplosiveSD)" 30
				"Pirate Drone (ExplosiveSD)" 20
	npc save
		to spawn
			has "Trace Hackerz Hope Ambush"
			"How to Hack a Science Drone For Fun and Profit" > 0
		government "Phenomenon (dangerous)"
		system destination
		personality target waiting staying vindictive marked mute
			confusion 60
		fleet
			variant
				"Combat Drone (Explosive)" 20
				"Mining Drone (Explosive)" 30
				"Pirate Drone (Explosive)" 20

	on fail
		clear "Trace Hackerz Hope Ambush"
		log `The Hackerz set up a trap at the abandoned "Subsi Land" amusement park on Hope. I was able to avoid being killed by robots armed with gatling guns and drones rigged with explosives.`
		dialog `These drones must be rigged with explosives.`

ship "Combat Drone" "Combat Drone (ExplosiveSD)"
	add attributes
		"self destruct" 1
		weapon
			"blast radius" 45
			"shield damage" 450
			"hull damage" 225
			"hit force" 675
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Combat Drone" "Combat Drone (Explosive)"
	add attributes
		"self destruct" .50
		weapon
			"blast radius" 45
			"shield damage" 450
			"hull damage" 225
			"hit force" 675
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Mining Drone" "Mining Drone (ExplosiveSD)"
	add attributes
		"self destruct" 1
		weapon
			"blast radius" 43
			"shield damage" 430
			"hull damage" 215
			"hit force" 645
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Mining Drone" "Mining Drone (Explosive)"
	add attributes
		"self destruct" .50
		weapon
			"blast radius" 43
			"shield damage" 430
			"hull damage" 215
			"hit force" 645
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Pirate Drone" "Pirate Drone (ExplosiveSD)"
	add attributes
		"self destruct" 1
		weapon
			"blast radius" 45
			"shield damage" 450
			"hull damage" 225
			"hit force" 675
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Pirate Drone" "Pirate Drone (Explosive)"
	add attributes
		"self destruct" .50
		weapon
			"blast radius" 45
			"shield damage" 450
			"hull damage" 225
			"hit force" 675
	explode "small explosion" 5
	"final explode" "final explosion medium"

mission "Hackerz 6"
	job
	clearance `Odd... There is no response to your hail.`
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <destination>. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination "Huginn Station"
	to offer
		has "Hackerz 5: failed"
		"combat rating" >= 8000
		random < 25
	to complete
		never
	on accept
		conversation
			scene "planet/station16"
			`Huginn Station is a high security prison. With your previous experiences tracking down the Hackerz, this is almost certain to be a trap...`
			``
			`But you've chosen to go anyway.`
	on visit
		conversation
			branch revisit
				has "Trace Hackerz Prison Break"
			scene "outfit/security station"
			`No one greets you at the air lock and the <planet> port authority isn't responding to your hails. The security station is abandoned, allowing you access to restricted areas of the station. It could be a problem if security catches you inside armed with anything more significant than your side arm.`
			choice
				`	(Check the command station.)`
					goto command
				`	(Check the prison cells.)`
					goto prison
				`	(Check the cargo bay.)`
					goto cargo

			label command
			scene "outfit/command center"
			action
				set "Trace Hackerz Prison Break"
				"reputation: Republic" <?= -1000
			`	You head for the station's command center to get answers. Along the way, you notice blood stains on the floors and walls. Something is definitely wrong here. When you finally arrive, the area is deserted. The communications equipment is damaged, allowing incoming transmissions to be received, but none to be sent. As you take all this in, someone hails the station: "Attention escaped prisoners and their allies. The Republic will not tolerate a prison break of this magnitude. You have all been sentenced to death."`
			`	Allies? Could the Navy be referring to you? Looking around the blood splattered consoles, you realize it may not be a good idea to be here when they arrive. Getting back to your ship and fleeing the station may be your only shot at survival.`
				launch

			label prison
			scene "outfit/brig"
			`	You head for the prison cells to make sure the convicts are still locked away. The blood stains in the hallways aren't a good sign. When you look into the first prison cell, you find the dead bodies of uniformed prison guards.`
			`	"You! You're responsible for this!" A man enters the cell block with a rifle pointed at you. It appears to be another bounty hunter. "I finally caught the Hackerz mastermind. Must be my lucky day!"`
			choice
				`	"It wasn't me!"`
				`	"I'm not going to let you frame me for this."`
			scene "outfit/sniper rifle"
			`	"Just what I'd expect from the Hackerz mastermind!" The man charges at you. What do you do?`
			choice
				`	(Try to knock him out.)`
					goto bounty1
				`	(Shoot him.)`
					goto bounty2
				`	(Talk some sense into him.)`
					goto bounty3
			label bounty1
			scene "outfit/brig"
			`	He raises the rifle overhead to try and knock you out, but you quickly step in with a series of punches that knock him off balance. As he falls, you leap in and pummel him into submission. Rather than haul him around the station, it is probably safer to keep him locked up in one of the empty cells.`
			choice
				`	(Check the command station.)`
					goto command
				`	(Check the cargo bay.)`
					goto cargo
			label bounty2
			scene "outfit/sniper rifle"
			`	You decide to go for the kill. As you draw your weapon, the man levels the muzzle of his rifle to aim for your chest.`
			branch bounty2hit
				random < 50
			`	He pulls the trigger first, blasting a hole into your chest. "Damn," he exclaims. "I wonder if I can still get the reward." Those would be the last words you hear before you die.`
				die
			label bounty2hit
			`	You pull the trigger first and put him down. As you stand over the dead man, you wonder if this situation can still be salvaged with the station authorities.`
			choice
				`	(Check the command station.)`
					goto command
			label bounty3
			scene "outfit/brig"
			`	He raises the rifle overhead and knocks you out. You awaken some time later locked in a prison cell. Apparently, you've been found guilty of hacking into the prison security system and orchestrating this prison break. Due to the especially violent and gruesome nature of this particular prison break, you've been sentenced to death. The execution is set to take place immediately.`
				die

			label cargo
			scene "outfit/cargo expansion"
			`	For some reason, you've decided to check out the cargo bay. With the security station abandoned, perhaps you'll be able to help yourself to some unattended cargo...`
			choice
				`	(Nah, check the command center.)`
					goto command
				`	(Nah, check the prison cells.)`
					goto prison
				`	(Time to pick up some sweet loot!)`
			scene "scene/scene-bloodyknife"
				Unfortunately, you run into some escaped prisoners! The noise from your scuffle attracts more escaped prisoners. There must be a major prison break in progress. Did the Hackerz compromise the prison security system? You'll never know. One of the prisoners stabbed you in the back with an improvised knife and you die from the blood loss.`
					die

			label revisit
			scene "scene/scene-weapons cache"
			`	When you return, your airlock is overrun by hundreds of rioting prisoners armed with weapons stolen from the station's armory! You are killed as the <ship> is quickly overtaken.`
				die
	npc
		government "Independent (Killable)"
		system destination
		personality waiting staying surveillance mute
		fleet
			names "republic fighter"
			fighters
				names "republic fighter"
			variant
				"Surveillance Drone (ExplosiveSD)" 4
				"Beacon Drone (ExplosiveSD)" 4
	npc save
		to spawn
			has "Trace Hackerz Prison Break"
			"ships: Heavy Warship" + "ships: Medium Warship" + "ships: Heavy Freighter" + "ships: Utility" + "ships: Superheavy" >= 7
		government "Republic"
		system destination
		personality target waiting vindictive nemesis
		fleet
			names "republic capital"
			fighters
				names "republic fighter"
			cargo 3
			outfitters "Ammo North"
			variant
				"Carrier"
				"Lance" 4
				"Combat Drone" 6
	npc save
		to spawn
			has "Trace Hackerz Prison Break"
			"ships: Heavy Warship" + "ships: Medium Warship" + "ships: Heavy Freighter" + "ships: Utility" + "ships: Superheavy" >= 5
		government "Republic"
		system destination
		personality target waiting vindictive nemesis
		fleet
			names "republic small"
			cargo 3
			outfitters "Ammo North"
			variant
				"Frigate"
				"Gunboat"
				"Rainmaker"
	npc save
		to spawn
			has "Trace Hackerz Prison Break"
		government "Republic"
		system destination
		personality target waiting vindictive nemesis
		fleet
			names "republic capital"
			fighters
				names "republic fighter"
			cargo 3
			outfitters "Ammo North"
			variant
				"Cruiser"
				"Gunboat"
				"Rainmaker"
				"Combat Drone" 4
	on fail
		clear "Trace Hackerz Prison Break"
		log `The Hackerz set up a trap at Huginn Station, a high security station. They remotely unlocked all the prison cells, which resulted in a violent riot. To make matters worse, I was suspected of aiding the prisoners due to my presence on the station while the riot was in progress.`

ship "Surveillance Drone" "Surveillance Drone (ExplosiveSD)"
	add attributes
		"self destruct" 1
		weapon
			"blast radius" 43
			"shield damage" 430
			"hull damage" 215
			"hit force" 645
	explode "small explosion" 5
	"final explode" "final explosion medium"

ship "Beacon Drone" "Beacon Drone (ExplosiveSD)"
	add attributes
		"self destruct" 1
		weapon
			"blast radius" 43
			"shield damage" 430
			"hull damage" 215
			"hit force" 645
	explode "small explosion" 5
	"final explode" "final explosion medium"


mission "Hackerz 6 Log Patch"
	landing
	invisible
	to offer
		has "Hackerz 6: failed"
		has "Trace Hackerz Prison Break"
	on offer
		clear "Trace Hackerz Prison Break"
		log `The Hackerz set up a trap at Huginn Station, a high security station. They remotely unlocked all the prison cells, which resulted in a violent riot. To make matters worse, I was suspected of aiding the prisoners due to my presence on the station while the riot was in progress.`
		fail

mission "Hackerz 7"
	job
	name "Trace Hackerz"
	description "The source of the mysterious Hackerz has been traced back to <destination>. Apprehend these criminals and bring them in for a reward of 1,000,000 credits."
	source
		government "Republic" "Syndicate" "Free Worlds"
	destination "New America"
	to offer
		has "Hackerz 6: failed"
		random < 25
	to complete
		never
	on accept
		conversation
			scene "planet/desert4"
			`New America is an isolated world sparsely populated with anarchists. With your previous experiences tracking down the Hackerz, this is almost certain to be a trap...`
			``
			`But you've chosen to go anyway.`
			choice
				`	(Prepare for launch.)`
			branch syndicate
				not "tribute: Earth"
			branch sol
				or
					has "tribute: Luna"
					has "tribute: Mars"
					has "tribute: I.S.S."
			action
				"tribute: Earth" <?= 0
			scene "outfit/unknown"
			`	Suddenly, you receive a message from Earth's government. "The Republic appreciates that you've released Earth from your tribute requirements." You don't recall making an offer to relinquish the tribute on Earth...`
				goto syndicate
			label sol
			action
				"tribute: Earth" <?= 0
			scene "outfit/unknown"
			`	Suddenly, you receive a message from Earth's government. "The Republic appreciates that you've released Earth from your tribute requirements. We ask that you consider releasing the rest of Sol as well." You don't recall making an offer to relinquish the tribute on Earth...`
			choice
				`	(Release tribute for the rest of Sol.)`
				`	(Ignore their request.)`
					goto syndicate
			action
				"reputation: Republic" >?= 10
				"tribute: Luna" <?= 0
				"tribute: Mars" <?= 0
				"tribute: I.S.S." <?= 0
			`	You release tribute from the rest of Sol...`
			label syndicate
			branch FW
				not "tribute: Foundry"
			branch hephaestus
				has "tribute: Hephaestus"
			action
				"tribute: Foundry" <?= 0
			scene "outfit/unknown"
			`	You get an alert informing you that a message from the Syndicate has arrived. "The Syndicate is grateful that you've released Foundry from your tribute requirements." You don't recall making an offer to relinquish the tribute on Foundry...`
				goto FW
			label hephaestus
			action
				"tribute: Foundry" <?= 0
			scene "outfit/unknown"
			`	You get an alert informing you that a message from the Syndicate has arrived. "The Syndicate is grateful that you've released Foundry from your tribute requirements. We ask that you release Hephaestus as well." You don't recall making an offer to relinquish the tribute on Foundry...`
			choice
				`	(Release tribute for Hephaestus.)`
				`	(Ignore their request.)`
					goto FW
			action
				"reputation: Syndicate" >?= 10
				"tribute: Hephaestus" <?= 0
			`	You release tribute from Hephaestus...`
			label FW
			branch end
				not "tribute: Bourne"
			branch militia
				has "license: Militia"
			action
				"tribute: Bourne" <?= 0
			scene "outfit/unknown"
			`	When you get back aboard the <ship>, you receive a message from Bourne. "The Free Worlds appreciates your offer to relinquish Bourne's tribute commitment. We gratefully accept." You don't recall making an offer to relinquish the tribute on Bourne...`
				goto end
			label militia
			scene "outfit/unknown"
			`	When you get back aboard the <ship>, a representative from the Free Worlds contacts you. "Greetings Captain <last>! I need to confirm if your request to relinquish tribute on Bourne is real. While the Free Worlds appreciates the offer, I just wanted to make sure this wasn't a miscommunication or some sort of hacking fraud." You don't recall making an offer to relinquish the tribute on Bourne...`
			choice
				`	(Release tribute for Bourne.)`
				`	(Deny making this request.)`
					goto end
			action
				"reputation: Free Worlds" >?= 10
				"tribute: Bourne" <?= 0
			`	You release tribute from Bourne...`
			label end
			scene "outfit/attention"
			`	After completing launch preparations you get a message, but the data inside is corrupted...`
	on visit "New America"
		conversation
			branch ambush
				has "hackerz new america ambush"
			`Your search for the Hackerz has brought you to New America. It continues to be sparsely populated by anarchists who value their privacy. While exploring one of the abandoned ghost towns, you notice a Surveillance Drone observing you.`
			label choose
			choice
				`	(Try to communicate with it.)`
				`	(Shoot it down.)`
					goto shoot
				`	(Return to the <ship>.)`
					goto ship
			`	The drone responds with a series of beeps and chirps.`
				goto choose
			label shoot
			scene "scene/scene-explosion"
			`	The drone must have been rigged with a bomb. It explodes more violently than you expected a normal Surveillance Drone to, engulfing you in the blast despite maintaining what should have been a safe distance.`
				die
			label ship
			action
				set "hackerz new america ambush"
			`	Remaining on the surface could be dangerous. You retreat to the safety of the <ship> and fire up the engines.`
				launch
			label ambush
			`	You find no refuge on the surface. The automated ships are still a threat.`
				launch
	npc
		government "Independent (Killable)"
		system destination
		personality waiting staying surveillance mute
		fleet
			names "republic fighter"
			fighters
				names "republic fighter"
			variant
				"Surveillance Drone (ExplosiveSD)" 5
				"Beacon Drone (ExplosiveSD)" 5
	npc save
		to spawn
			has "hackerz new america ambush"
			"ships: Heavy Warship" + "ships: Medium Warship" + "ships: Heavy Freighter" + "ships: Utility" + "ships: Superheavy" >= 7
		government "Test Dummy"
		system destination
		personality target waiting vindictive nemesis mute
			confusion 120
		fleet
			names "error test ship"
			variant
				"Leviathan Test Dummy"
				"Mule Test Dummy"
				"Firebird Test Dummy"
				"Berserker Test Dummy2"
				"Combat Drone (ExplosiveSD)" 4
				"Mining Drone (ExplosiveSD)" 2
				"Pirate Drone (ExplosiveSD)" 4
	npc save
		to spawn
			has "hackerz new america ambush"
			"ships: Heavy Warship" + "ships: Medium Warship" + "ships: Heavy Freighter" + "ships: Utility" + "ships: Superheavy" >= 4
		government "Test Dummy"
		system destination
		personality target waiting vindictive nemesis mute
			confusion 120
		fleet
			names "error test ship"
			variant
				"Falcon Test Dummy"
				"Modified Argosy Test Dummy"
				"Argosy Test Dummy"
				"Hauler Test Dummy"
				"Combat Drone (ExplosiveSD)" 4
				"Mining Drone (ExplosiveSD)" 2
				"Pirate Drone (ExplosiveSD)" 4
	npc save
		government "Test Dummy"
		system destination
		personality target waiting vindictive nemesis mute
			confusion 120
		fleet
			names "error test ship"
			variant
				"Vanguard Test Dummy2"
				"Splinter Test Dummy2"
				"Quicksilver Test Dummy2"
				"Freighter Test Dummy"
				"Combat Drone (ExplosiveSD)" 4
				"Mining Drone (ExplosiveSD)" 2
				"Pirate Drone (ExplosiveSD)" 4
	on fail
		clear "hackerz new america ambush"
		log `The Hackerz set up an ambush at New America, an isolated anarchist world. In addition to drones, a fleet of automated Test Dummy ships was arrayed against me.`
		dialog `You've survived the automated ship assault...`



########################
# Random Science Drones to hack
########################



mission "Hackerz: Add Science Drones"
	landing
	invisible
	on offer
		event "add science drones"
		fail

event "add science drones"
	system Mintaka
		add fleet "Science Drone" 4000
	system Rigel
		add fleet "Science Drone" 4000
	system Mirzam
		add fleet "Science Drone" 4000
	system Hassaleh
		add fleet "Science Drone" 4000
	system Sumar
		add fleet "Science Drone" 4000
	system Rajak
		add fleet "Science Drone" 4000
	system "Ultima Thule"
		add fleet "Science Drone" 4000
	system Cardax
		add fleet "Science Drone" 4000
	system Orbona
		add fleet "Science Drone" 4000
	system Terminus
		add fleet "Science Drone" 4000
	system Limen
		add fleet "Science Drone" 4000
	system Mora
		add fleet "Science Drone" 4000
	system Fala
		add fleet "Science Drone" 4000
	system Algieba
		add fleet "Science Drone" 4000
	system Muphrid
		add fleet "Science Drone" 4000
	system Mizar
		add fleet "Science Drone" 4000
	system Gacrux
		add fleet "Science Drone" 4000
	system Holeb
		add fleet "Science Drone" 4000
	system Tais
		add fleet "Science Drone" 4000
	system Wei
		add fleet "Science Drone" 4000
	system Alnasl
		add fleet "Science Drone" 4000
	system Eber
		add fleet "Science Drone" 4000
	system "Alpha Arae"
		add fleet "Science Drone" 4000
	system Eltanin
		add fleet "Science Drone" 4000
	system Moktar
		add fleet "Science Drone" 4000
	system Oblate
		add fleet "Science Drone" 4000
	system Eteron
		add fleet "Science Drone" 4000
	system Persian
		add fleet "Science Drone" 4000
	system Lurata
		add fleet "Science Drone" 4000
	system Lesath
		add fleet "Science Drone" 4000
	system "Beta Lupi"
		add fleet "Science Drone" 4000
	system Zubenelgenubi
		add fleet "Science Drone" 4000
	system Minkar
		add fleet "Science Drone" 4000
	system Volax
		add fleet "Science Drone" 4000
	system Sospi
		add fleet "Science Drone" 4000
	system Unagi
		add fleet "Science Drone" 4000
	system Hatysa
		add fleet "Science Drone" 4000
	system Gorvi
		add fleet "Science Drone" 4000
	system Tortor
		add fleet "Science Drone" 4000
	system Danoa
		add fleet "Science Drone" 4000
	system Durax
		add fleet "Science Drone" 4000
	system Kugel
		add fleet "Science Drone" 4000
	system "Gamma Cassiopeiae"
		add fleet "Science Drone" 4000
	system Regulus
		add fleet "Science Drone" 4000
	system Fingol
		add fleet "Science Drone" 4000
	system Nocte
		add fleet "Science Drone" 4000
	system Ipsing
		add fleet "Science Drone" 4000
	system Hintar
		add fleet "Science Drone" 4000
	system Orvala
		add fleet "Science Drone" 4000
	system Boral
		add fleet "Science Drone" 4000
	system Naper
		add fleet "Science Drone" 4000
	system Ildaria
		add fleet "Science Drone" 4000
	system Sadr
		add fleet "Science Drone" 4000
	system Umbral
		add fleet "Science Drone" 4000



########################
# Harmony & New Tibet get a Hackerz defense
########################



mission "Hackerz: New Tibet Harmony Reparations"
	landing
	invisible
	to offer
		"combat rating" > 3500
	on offer
		event "new tibet harmony reparations"
		fail
		
event "new tibet harmony reparations"
	planet Harmony
		tribute -100
			threshold 3500
			fleet "Hackerz Dfens" 2
	planet "New Tibet"
		tribute -100
			threshold 3500
			fleet "Hackerz Dfens" 2

phrase "hackerz ID"
	word
		"ID#"
	phrase
		"digit"
	phrase
		"digit"
	phrase
		"digit"
	phrase
		"digit"

fleet "Hackerz Dfens"
	government "Hackerz"
	names "hackerz ID"
	personality surveillance
	cargo 0
	variant 1
		"Hacker Drone" 3
	variant 2
		"Hacker Drone" 4
	variant 1
		"Hacker Drone" 5

mission "Hackerz: New Tibet Reparations"
	landing
	invisible
	source "New Tibet"
	to offer
		"tribute: New Tibet" < 0
	on offer
		conversation
			scene "ship/science drone"
			`The message you received when the planet surrendered to your tribute demand was as strange as their defense fleet. Soon after landing, a delegation of monks approaches you. "Greetings <first> <last>, captain of the <ship>. We are grateful for your charitable donation to our planetary finances." The monks peacefully depart as you check your account transactions... Somehow, it has been set to pay New Tibet 100 credits per day in reparations. That's 36000 credits per year! Those Hacker Drones may be a more effective deterrent than a fleet of warships.`
				decline

mission "Hackerz: New Tibet Sentry"
	landing
	invisible
	source "New Tibet"
	to offer
		"tribute: New Tibet" < 0
	npc kill
		government "Hackerz"
		personality waiting surveillance
		ship "Hacker Drone" "Hackerz"
		conversation
			action
				set "You've been hacked"
			scene "ship/science drone"
			`	Your ship's hyperspace network relay starts making unusual sounds. After a moment it returns to normal...`
	on complete
		clear "Hackerz: New Tibet Sentry: offered"


mission "Hackerz: Harmony Reparations"
	landing
	invisible
	source Harmony
	to offer
		"tribute: Harmony" < 0
	on offer
		conversation
			scene "ship/science drone"
			`The message you received when the planet surrendered to your tribute demand was as strange as their defense fleet. Soon after landing, a delegation of monks approaches you. "Greetings <first> <last>, captain of the <ship>. We are grateful for your charitable donation to our planetary finances." The monks peacefully depart as you check your account transactions... Somehow, it has been set to pay Harmony 100 credits per day in reparations. That's 36000 credits per year! Those Hacker Drones may be a more effective deterrent than a fleet of warships.`
				decline

mission "Hackerz: Harmony Sentry"
	landing
	invisible
	source Harmony
	to offer
		"tribute: Harmony" < 0
	npc kill
		government "Hackerz"
		personality waiting surveillance
		ship "Hacker Drone" "Hackerz"
		conversation
			action
				set "You've been hacked"
			scene "ship/science drone"
			`	Your ship's hyperspace network relay starts making unusual sounds. After a moment it returns to normal...`
	on complete
		clear "Hackerz: Harmony Sentry: offered"
